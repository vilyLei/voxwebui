(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["CoUI"]=e():t["CoUI"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="fae3")}({"0e8f":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("b0fb");class n extends s.UIEntityBase{constructor(){super(),this.m_pw=10,this.m_ph=10,this.m_sx=1,this.m_sy=1,this.m_material=null,this.m_tex=null}initialize(t,e,i=128,s=128){if(null!=e&&this.isIniting()){this.init(),this.m_tex=e,this.m_uiScene=t,this.m_color=CoMaterial.createColor4(),this.m_tex.flipY=!0,this.m_tex.premultiplyAlpha=!0,this.m_tex.minFilter=CoRScene.TextureConst.LINEAR,this.m_tex.magFilter=CoRScene.TextureConst.NEAREST;let n=this.createMaterial(this.m_tex);this.m_material=n,CoMesh.plane.applyMaterial(n,!0);let l=CoMesh.plane.createXOY(0,0,1,1);this.m_pw=i,this.m_ph=s;let r=CoEntity.createDisplayEntity();r.setMaterial(n),r.setMesh(l),this.m_entities.push(r),this.applyRST(r),super.setScaleXY(this.m_sx*this.m_pw,this.m_sy*this.m_ph),this.update()}}setScaleXY(t,e){this.m_sx=t,this.m_sy=e,super.setScaleXY(t*this.m_pw,e*this.m_ph)}setScaleX(t){this.m_sx=t,super.setScaleX(t*this.m_pw)}setScaleY(t){this.m_sy=t,super.setScaleX(t*this.m_ph)}getScaleX(){return this.m_sx}getScaleY(){return this.m_sy}setColor(t){return this.m_color.copyFrom(t),null!=this.m_material&&this.m_material.setColor(t),this}getColor(){return this.m_color}destroy(){super.destroy(),this.m_material=null,this.m_uiScene=null,this.m_tex=null}}e.TextureLabel=n},"10ee":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.m_entities=[],this.m_opvs=[],this.m_initRect=null,this.m_offsetV=CoMath.createVec3()}setOffset(t){this.m_offsetV.copyFrom(t)}addUIEntity(t){if(null!=t){let e=0;for(;e<this.m_entities.length;++e)if(this.m_entities[e]==t)break;if(e>=this.m_entities.length){let e=CoMath.createVec3();t.getPosition(e),this.m_opvs.push(e),this.m_entities.push(t),null!=this.m_initRect&&this.initEntityLayout(t,this.m_initRect)}}}removeUIEntity(t){if(null!=t){let e=0;for(;e<this.m_entities.length;++e)if(this.m_entities[e]==t){this.m_entities.splice(e,1),this.m_opvs.splice(e,1);break}}}initLayout(t){if(null!=t){null!=this.m_initRect?this.m_initRect.copyFrom(t):this.m_initRect=t.clone();let e=this.m_entities;for(let t=0;t<e.length;++t)this.initEntityLayout(e[t],this.m_initRect)}}initEntityLayout(t,e){}applyLayout(t){}update(t){}destroy(){}}e.LayouterBase=s},1389:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.m_tipEntity=null}initialize(t,e=2){if(null==this.m_tipEntity){this.m_uiscene=t;let i=CoUI.createRectTextTip();i.initialize(t,e),this.m_tipEntity=i}}getTipEntity(t){return this.m_tipEntity}addTipsTarget(t,e){this.m_tipEntity.addEntity(t)}removeTipsTarget(t,e){this.m_tipEntity.removeEntity(t)}destroy(){}}e.TipsSystem=s},"14e2":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.m_pv=null}getPos(t,e,i,s,n){null==this.m_pv&&(this.m_pv=CoMath.createVec3());let l=this.m_pv,r=s.getHeight(),o=s.getWidth(),a=i.min;return l.x=a.x-2-o,l.y=e+2-r,l.y+r>n.getTop()&&(l.y=n.getTop()-2-r),l}}class n{constructor(){this.m_pv=null}getPos(t,e,i,s,n){null==this.m_pv&&(this.m_pv=CoMath.createVec3());let l=this.m_pv,r=s.getHeight(),o=i.max;return l.x=o.x+2,l.y=e+2-r,l.y+r>n.getTop()&&(l.y=n.getTop()-2-r),l}}class l{constructor(){this.m_pv=null}getPos(t,e,i,s,n){null==this.m_pv&&(this.m_pv=CoMath.createVec3());let l=this.m_pv,r=i.max,o=s.getWidth();return l.x=t+2,l.y=r.y+2,l.x+o>n.getRight()&&(l.x=n.getRight()-2-o),l}}class r{constructor(){this.m_pv=null}getPos(t,e,i,s,n){null==this.m_pv&&(this.m_pv=CoMath.createVec3());let l=this.m_pv,r=s.getHeight(),o=s.getWidth(),a=i.min;return l.x=t+2,l.y=a.y-2-r,l.x+o>n.getRight()&&(l.x=n.getRight()-2-o),l}}const o=new s,a=new n,h=new l,m=new r;class u{constructor(){this.m_content="ui entity tip info",this.m_aligner=null}setContent(t){return this.m_content=t,this}getCotent(){return this.m_content}alignLeft(){return this.m_aligner=o,this}alignRight(){return this.m_aligner=a,this}alignTop(){return this.m_aligner=h,this}alignBottom(){return this.m_aligner=m,this}getPos(t,e,i,n,l=null){return null==this.m_aligner&&(this.m_aligner=new s),this.m_aligner.getPos(t,e,i,n,l)}destroy(){this.m_aligner=null}}e.TipInfo=u},"1dd7":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("b0fb");class n extends s.UIEntityBase{constructor(){super(),this.m_pw=10,this.m_ph=10,this.m_sx=1,this.m_sy=1,this.m_material=null,this.m_tex=null,this.m_fontSize=24,this.m_text=""}initialize(t,e,i=24){if(""!=t&&this.isIniting()){i<8&&(i=8),this.m_fontSize=i,this.init(),this.m_text=t,this.m_uiScene=e;let s=CoEntity.createDisplayEntity();this.m_fontColor=CoMaterial.createColor4(),this.m_bgColor=CoMaterial.createColor4(1,1,1,0);let n=this.m_uiScene.texAtlas.createCharsImage(this.m_text,this.m_fontSize,this.m_fontColor,this.m_bgColor);this.m_tex=e.rscene.textureBlock.createImageTex2D(n.width,n.height),this.m_tex.setDataFromImage(n),this.m_tex.flipY=!0,this.m_tex.premultiplyAlpha=!0,this.m_tex.minFilter=CoRScene.TextureConst.LINEAR,this.m_tex.magFilter=CoRScene.TextureConst.NEAREST;let l=this.createMaterial(this.m_tex);this.m_material=l,CoMesh.plane.setBufSortFormat(l.getBufSortFormat());let r=CoMesh.plane.createXOY(0,0,1,1);this.m_pw=n.width,this.m_ph=n.height,s.setMaterial(l),s.setMesh(r),this.m_entities.push(s),this.applyRST(s),super.setScaleXY(this.m_sx*this.m_pw,this.m_sy*this.m_ph),this.update()}}setScaleXY(t,e){this.m_sx=t,this.m_sy=e,super.setScaleXY(t*this.m_pw,e*this.m_ph)}setScaleX(t){this.m_sx=t,super.setScaleX(t*this.m_pw)}setScaleY(t){this.m_sy=t,super.setScaleX(t*this.m_ph)}getScaleX(){return this.m_sx}getScaleY(){return this.m_sy}setText(t){if(null!=this.m_tex&&""!=t&&this.m_text!=t){this.m_text=t;let e=this.m_uiScene.texAtlas.createCharsImage(t,this.m_fontSize,this.m_fontColor,this.m_bgColor);this.m_tex.setDataFromImage(e,0,0,0,!0),this.m_tex.updateDataToGpu(),this.m_pw=e.width,this.m_ph=e.height,super.setScaleXY(this.m_sx*this.m_pw,this.m_sy*this.m_ph),this.update()}}getText(){return this.m_text}setColor(t){return this.m_fontColor.copyFrom(t),null!=this.m_material&&this.m_material.setColor(t),this}getColor(){return this.m_fontColor}destroy(){super.destroy(),this.m_material=null,this.m_uiScene=null,this.m_tex=null}}e.TextLabel=n},"1eb2":function(t,e,i){"use strict";if("undefined"!==typeof window){var s=window.document.currentScript,n=i("8875");s=n(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:n});var l=s&&s.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);l&&(i.p=l[1])}},2870:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("3914"),n=i("bb62"),l=i("eb56");class r{static createCurrTextBtn(t,e,i,r,o,a=null){if(null!==o.text&&""!=o.text){let h=new n.ClipColorLabel;h.initializeWithoutTex(t,e,4),h.setColors(a);let m=new s.ClipLabel;m.depthTest=!0,m.transparent=!0,m.premultiplyAlpha=!0,m.initialize(r,[o.text]),m.setColor(o.textColor);let u=new l.Button;return u.uuid=i,u.addLabel(m),u.initializeWithLable(h),u}return null}static createTextButton(t,e,i,s,n,l){let o=n,a=s.createCharsCanvasFixSize(t,e,o.text,o.fontSize,CoMaterial.createColor4(),CoMaterial.createColor4(1,1,1,0));return s.addImageToAtlas(o.text,a),r.createCurrTextBtn(t,e,i,s,n,l)}static createPanelBtnWithCfg(t,e,i,s,n){let l=t.transparentTexAtlas,r=t.uiConfig,o=n.btnSize,a=o[0],h=o[1],m=n.btnNames,u=n.btnKeys,c=n.btnTips,_=n.btnTextFontFormat;l.setFontName(_.font);let p=CoMaterial.createColor4();p.fromBytesArray3(r.getUIGlobalColor().text);let d=CoMaterial.createColor4(1,1,1,0),g=l.createCharsCanvasFixSize(a,h,m[s],_.fontSize,p,d);l.addImageToAtlas(m[s],g);let f=CoUI.createClipColorLabel();f.initializeWithoutTex(a,h,4);let y=CoUI.createClipLabel();y.transparent=!0,y.premultiplyAlpha=!0,y.initialize(l,[m[s]]);let C=CoUI.createButton();C.uuid=u[s],C.addLabel(y),C.initializeWithLable(f);let b="right",x=n.buttonStyle;if(void 0!=x&&void 0!=x.globalColor&&(b=x.tipsAlign,r.applyButtonGlobalColor(C,x.globalColor)),c.length>s){t.tips.addTipsTarget(C);let e=CoUI.createTipInfo().setContent(c[s]);switch(b){case"top":C.info=e.alignTop();break;case"bottom":C.info=e.alignBottom();break;default:C.info=e.alignRight();break}}return C.setXY(e,i),C}}e.ButtonBuilder=r},3914:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("67d8");class n extends s.ClipLabelBase{constructor(){super(),this.m_material=null}createMesh(t,e){let i=4,s=[0,1,2,0,2,3];const n=this.m_total;let l=new Uint16Array(6*n),r=new Float32Array(12*n),o=new Float32Array(8*n);this.m_sizes=new Array(2*n);let a=0;for(let m=0;m<n;++m){const n=t.getTexObjFromAtlas(e[m]);l.set(s,m*s.length),r.set(this.createVS(0,0,n.getWidth(),n.getHeight()),12*m),o.set(n.uvs,8*m);for(let t=0;t<s.length;++t)s[t]+=i;this.m_sizes[a++]=n.getWidth(),this.m_sizes[a++]=n.getHeight()}let h=CoMesh.createRawMesh();return h.reset(),h.setIVS(l),h.addFloat32Data(r,3),h.addFloat32Data(o,2),h.initialize(),h}hasTexture(){return!0}initialize(t,e){if(this.isIniting()&&null!=t&&null!=e&&e.length>0){this.init(),this.m_pos=CoMath.createVec3(),this.m_total=e.length;let i=t.getTexObjFromAtlas(e[0]),s=this.createMesh(t,e);this.m_vtCount=s.vtCount,this.m_material=this.createMaterial(i.texture),this.m_material.vtxInfo=CoRScene.createVtxDrawingInfo();let n=CoEntity.createDisplayEntity();n.setMaterial(this.m_material),n.setMesh(s),n.setIvsParam(0,this.m_step),this.m_entities.push(n),this.applyRST(n),this.setClipIndex(0)}}initializeWithLable(t){if(this.isIniting()&&null!=t&&t!=this){if(t.getClipsTotal()<1)throw Error("Error: srcLable.getClipsTotal() < 1");this.init();let e=t.getREntities();for(let i=0;i<e.length;++i){let s=e[i],n=s.getMesh();this.m_pos=CoMath.createVec3();let l=s.getMaterial().getTextureAt(0),r=this.m_total=t.getClipsTotal();this.m_sizes=new Array(2*r);let o=0;for(let e=0;e<r;++e)this.m_sizes[o++]=t.getClipWidthAt(e),this.m_sizes[o++]=t.getClipHeightAt(e);this.m_vtCount=n.vtCount,this.m_material=this.createMaterial(l),this.m_material.vtxInfo=CoRScene.createVtxDrawingInfo();let a=CoEntity.createDisplayEntity();a.setMaterial(this.m_material),a.setMesh(n),a.setIvsParam(0,this.m_step),this.m_entities.push(a),this.applyRST(a)}this.setClipIndex(0)}}displaceFromLable(t){if(null!=t&&t!=this&&t.getClipsTotal()<1)throw Error("Error: srcLable.getClipsTotal() < 1")}setColor(t){null!=this.m_material&&this.m_material.setColor(t)}getColor(t){null!=this.m_material&&this.m_material.getColor(t)}setClipIndex(t){if(t>=0&&t<this.m_total){this.m_index=t;let e=this.m_entities;for(let i=0;i<e.length;++i)e[i].getMaterial().vtxInfo.setIvsParam(t*this.m_step,this.m_step);t<<=1,this.m_width=this.m_sizes[t],this.m_height=this.m_sizes[t+1]}}}e.ClipLabel=n},"39ac":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t=!0){this.m_map=new Map,this.m_selectFunc=null,this.m_deselectFunc=null,this.m_mouseUpSelect=!0,this.m_btn=null,this.m_mouseUpSelect=t}addButton(t){if(null!=t){null==this.m_map&&(this.m_map=new Map),this.m_map.set(t.uuid,t);const e=CoRScene.MouseEvent;this.m_mouseUpSelect?t.addEventListener(e.MOUSE_UP,this,this.mouseEvtFunc):t.addEventListener(e.MOUSE_DOWN,this,this.mouseEvtFunc)}}mouseEvtFunc(t){this.select(t.currentTarget.uuid)}setSelectedFunction(t,e){this.m_selectFunc=t,this.m_deselectFunc=e}select(t){if(null!=this.m_map&&this.m_map.has(t)){let e=this.m_map.get(t);this.m_btn!=e&&(null!=this.m_btn&&null!=this.m_deselectFunc&&this.m_deselectFunc(this.m_btn),this.m_btn=e,null!=this.m_selectFunc&&this.m_selectFunc(e))}}destroy(){this.m_btn=null,this.m_map=null,this.m_selectFunc=null,this.m_deselectFunc=null}}e.SelectButtonGroup=s},"3f49":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("b0fb");class n extends s.UIEntityBase{constructor(){super(),this.m_color=null,this.m_material=null}createMesh(t){let e=new Uint16Array([0,1,2,0,2,3]),i=new Float32Array(this.createVS(0,0,this.m_width,this.m_height)),s=CoMesh.createRawMesh();return s.reset(),s.setBufSortFormat(t.getBufSortFormat()),s.setIVS(e),s.addFloat32Data(i,3),s.initialize(),s}initialize(t,e){if(this.isIniting()){this.init(),this.m_width=t,this.m_height=e;let i=CoMaterial.createDefaultMaterial();i.initializeByCodeBuf(!1),this.m_color=CoMaterial.createColor4();let s=this.createMesh(i),n=CoEntity.createDisplayEntity();n.setMaterial(i),n.setMesh(s),this.applyRST(n),this.m_entities.push(n),this.m_material=i}}setColor(t){return this.m_color.copyFrom(t),null!=this.m_material&&this.m_material.setColor(t),t}getColor(){return this.m_color}destroy(){super.destroy(),this.m_material=null}}e.ColorLabel=n},"3f7d":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("ccfe");class n{constructor(){this.m_promptPanel=null}initialize(t,e=3){if(null==this.m_promptPanel){this.m_uiscene=t;let i=t.uiConfig,n=i.getUIPanelCfgByName("promptPanel"),l=n.panelSize,r=n.btnSize,o=n.btnNames,a=new s.PromptPanel;a.initialize(this.m_uiscene,e,l[0],l[1],r[0],r[1],o[0],o[1]),a.setZ(3);let h=CoMaterial.createColor4();h.fromBytesArray3(n.bgColor),a.setBGColor(h),this.m_promptPanel=a}}setPromptListener(t,e,i=0){null!=this.m_promptPanel&&this.m_promptPanel.setListener(t,e)}showPrompt(t,e=0){null!=this.m_promptPanel&&(this.m_promptPanel.setPrompt(t),this.m_promptPanel.open())}setPromptTextColor(t,e=0){null!=this.m_promptPanel&&this.m_promptPanel.setPromptTextColor(t)}setPromptBGColor(t,e=0){null!=this.m_promptPanel&&this.m_promptPanel.setBGColor(t)}getPromptPanel(t=0){return this.m_promptPanel}}e.PromptSystem=n},5870:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("af66"),n=i("0e8f");class l extends s.UIPanel{constructor(){super(),this.m_marginWidth=15,this.m_callback=null,this.m_initing=!0,this.m_pixelsW=256,this.m_pixelsH=256}initialize(t,e,i=260,s=260,n=3){this.isIniting()&&(this.init(),this.m_marginWidth=n,this.m_scene=t,this.m_rpi=e,this.m_panelW=i,this.m_panelH=s,null==this.m_bgColor&&(this.m_bgColor=CoMaterial.createColor4()))}destroy(){super.destroy()}setSelectColorCallback(t){this.m_callback=t}buildPanel(t,e){this.buildItems()}buildItems(){if(this.m_initing){this.m_initing=!1;let t=this.getScene(),e="static/assets/colors.png",i=this.m_marginWidth,s=this.m_panelW-2*i,l=this.m_panelH-2*i,r=this.createTexByUrl(e),o=new n.TextureLabel;o.initialize(t,r,s,l),o.setXY(i,i),this.addEntity(o)}}getRGBAByXY(t,e){t|=0,e|=0,t<0&&(t=0),e<0&&(e=0),t>255&&(t=255),e>255&&(e=255),e=255-e,null==this.m_color&&(this.m_color=CoMaterial.createColor4());let i=this.m_pixels;if(null!=this.m_pixels){let s=4*(e*this.m_pixelsW+t),n=i[s],l=i[s+1],r=i[s+2];this.m_color.setRGB3Bytes(n,l,r)}return this.m_color}createColorData(t){let e=document.createElement("canvas");e.style.display="bolck",e.style.overflow="hidden",e.style.left="0px",e.style.top="0px",e.style.position="absolute",e.width=t.width,e.height=t.height;let i=e.getContext("2d");i.drawImage(t,0,0);let s=i.getImageData(0,0,t.width,t.height);this.m_pixels=s.data}createTexByUrl(t=""){let e=this.getScene(),i=e.rscene.textureBlock.createImageTex2D(64,64,!1),s=new Image;return s.onload=t=>{this.createColorData(s),i.setDataFromImage(s,0,0,0,!1)},s.src=t,i}openThis(){let t=CoRScene.MouseEvent;null!=this.m_scene&&this.m_scene.addEventListener(t.MOUSE_DOWN,this,this.stMouseDownListener)}closeThis(){let t=CoRScene.MouseEvent;null!=this.m_scene&&this.m_scene.removeEventListener(t.MOUSE_DOWN,this,this.stMouseDownListener),this.m_callback=null}stMouseDownListener(t){let e=t.mouseX,i=t.mouseY,s=this.m_v0;if(s.setXYZ(e,i,0),this.globalToLocal(s),s.x<0||s.x>this.m_panelW||s.y<0||s.y>this.m_panelH)this.close();else{let t=this.m_marginWidth;s.x-=t,s.y-=t;let e=this.getRGBAByXY(s.x,s.y);null!=this.m_callback&&this.m_callback(e)}}layout(){}}e.ColorPickPanel=l},"5d8c":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("b0fb");class n extends s.UIEntityBase{constructor(){super(),this.m_pw=10,this.m_ph=10,this.m_rpi=0,this.m_texAtlas=null,this.m_tex=null,this.m_fontSize=24,this.m_text="tipsInfo",this.premultiplyAlpha=!0}initialize(t,e=0,i=24,s=null,n=null){if(this.isIniting()){e<0&&(e=0),i<12&&(i=12),this.m_texAtlas=t.texAtlas,this.init(),this.m_uiScene=t,this.m_rpi=e;let l=CoEntity.createDisplayEntity(),r=t.uiConfig,o=r.getUIGlobalText().fontFormat.tips;this.m_fontSize=o.fontSize,this.m_fontColor=null==s?r.createColorByData(o.fontColor):s,this.m_bgColor=null==n?CoMaterial.createColor4(.1,.1,.1,.5):n;let a=this.m_texAtlas.createCharsImage(this.m_text,this.m_fontSize,this.m_fontColor,this.m_bgColor);this.m_tex=t.rscene.textureBlock.createImageTex2D(a.width,a.height),this.m_tex.setDataFromImage(a),this.m_tex.flipY=!0,this.m_tex.premultiplyAlpha=!0,this.m_tex.minFilter=CoRScene.TextureConst.LINEAR,this.m_tex.magFilter=CoRScene.TextureConst.NEAREST;let h=this.createMaterial(this.m_tex);CoMesh.plane.setBufSortFormat(h.getBufSortFormat());let m=CoMesh.plane.createXOY(0,0,1,1);this.m_pw=a.width,this.m_ph=a.height,l.setMaterial(h),l.setMesh(m),this.m_entities.push(l),this.applyRST(l),this.setScaleXY(a.width,a.height)}}addEntity(t){if(null!=t){const e=CoRScene.MouseEvent;t.addEventListener(e.MOUSE_OUT,this,this.targetMouseOut),t.addEventListener(e.MOUSE_OVER,this,this.targetMouseOver),t.addEventListener(e.MOUSE_MOVE,this,this.targetMouseMove)}}removeEntity(t){if(null!=t){const e=CoRScene.MouseEvent;t.removeEventListener(e.MOUSE_OUT,this,this.targetMouseOut),t.removeEventListener(e.MOUSE_OVER,this,this.targetMouseOver),t.removeEventListener(e.MOUSE_MOVE,this,this.targetMouseMove)}}moveTar(t,e,i){let s=t.getGlobalBounds(),n=t.info,l=n.getPos(e,i,s,this.getGlobalBounds(),this.m_uiScene.getRect());this.setXY(l.x,l.y),this.update()}targetMouseOver(t){null==this.getScene()&&this.m_uiScene.addEntity(this,this.m_rpi),this.setVisible(!0);let e=t.currentTarget;this.setText(e.info.getCotent()),this.moveTar(e,t.mouseX,t.mouseY)}targetMouseMove(t){let e=t.currentTarget;this.moveTar(e,t.mouseX,t.mouseY)}targetMouseOut(t){this.setVisible(!1)}setText(t){if(null!=this.m_tex&&""!=t&&this.m_text!=t){this.m_text=t;let e=this.m_texAtlas.createCharsImage(t,this.m_fontSize,this.m_fontColor,this.m_bgColor);this.m_tex.setDataFromImage(e,0,0,0,!0),this.m_tex.updateDataToGpu(),this.m_pw=e.width,this.m_ph=e.height,this.setScaleXY(e.width,e.height)}}getText(){return this.m_text}destroy(){super.destroy(),this.m_uiScene=null,null!=this.m_tex&&(this.m_tex=null),this.m_texAtlas=null}}e.RectTextTip=n},"5e13":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("b0fb");class n extends s.UIEntityBase{constructor(){super(),this.m_uientities=[]}init(){this.isIniting()&&(super.init(),this.m_rcontainer=CoRScene.createDisplayEntityContainer())}addedEntity(t){}removedEntity(t){}update(){for(let t=0;t<this.m_uientities.length;++t)this.m_uientities[t].update();null!=this.m_rcontainer&&this.m_rcontainer.update(),super.update()}addEntity(t){if(null!=t){let e=0;for(;e<this.m_uientities.length;++e)if(this.m_uientities[e]==t)break;if(e>=this.m_uientities.length){this.m_uientities.push(t),t.update();let e=t.getRContainer();null!=e&&this.m_rcontainer.addChild(e);let i=t.getREntities();for(let t=0;t<i.length;++t)this.m_rcontainer.addEntity(i[t]);this.addedEntity(t)}}}removeEntity(t){if(null!=t){let e=0;for(;e<this.m_uientities.length;++e)if(this.m_uientities[e]==t){this.m_uientities.splice(e,1);let i=t.getRContainer();null!=i&&this.m_rcontainer.removeChild(i);let s=t.getREntities();for(let t=0;t<s.length;++t)this.m_rcontainer.removeEntity(s[t]);this.removedEntity(t);break}}}globalToLocal(t){this.m_rcontainer.globalToLocal(t)}localToGlobal(t){this.m_rcontainer.localToGlobal(t)}getEneitysTotal(){return this.m_uientities.length}}e.UIEntityContainer=n},"67d8":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("b0fb");class n extends s.UIEntityBase{constructor(){super(),this.m_index=0,this.m_total=0,this.m_step=6,this.m_vtCount=0,this.m_sizes=null,this.uuid="label"}createVS(t,e,i,s){let n=t,l=e,r=t+i,o=e+s,a=0;return[n,l,a,r,l,a,r,o,a,n,o,a]}setClipIndex(t){}setCircleClipIndex(t){t%=this.m_total,t+=this.m_total,t%=this.m_total,this.setClipIndex(t)}getClipIndex(){return this.m_index}getClipsTotal(){return this.m_total}getClipWidthAt(t){return null==this.m_sizes?this.m_width:t>=0&&t<this.m_total?(t<<=1,this.m_sizes[t]):void 0}getClipHeightAt(t){return null==this.m_sizes?this.m_height:t>=0&&t<this.m_total?(t<<=1,this.m_sizes[t+1]):void 0}getClipWidth(){return this.m_width}getClipHeight(){return this.m_height}destroy(){this.m_sizes=null,this.m_total=0,super.destroy()}}e.ClipLabelBase=n},8351:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("10ee");class n extends s.LayouterBase{constructor(){super(),this.m_offsetvs=[]}update(t){const e=this.m_entities,i=e.length;let s=CoMath.createVec3();for(let n=0;n<i;++n)s.copyFrom(this.m_offsetvs[n]),s.x=t.width-s.x,s.addBy(this.m_offsetV),e[n].setPosition(s),e[n].update()}initEntityLayout(t,e){let i=CoMath.createVec3();t.getPosition(i),i.x=e.width-i.x,this.m_offsetvs.push(i)}destroy(){this.m_offsetvs=null,super.destroy()}}e.RightBottomLayouter=n},"85be":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("b0fb");class n extends s.UIEntityBase{constructor(){super(),this.m_index=0,this.m_total=0,this.m_colors=null,this.m_hasTex=!0,this.m_lb=null,this.m_ilb=null,this.uuid="colorClipLabel"}hasTexture(){return this.m_hasTex}setIconLabel(t){this.m_ilb=t}getIconLabel(){return this.m_ilb}initialize(t,e){if(this.isIniting()&&e>0){this.init(),this.m_lb=t;let i=new Array(e);for(let t=0;t<e;++t)i[t]=CoMaterial.createColor4();this.m_colors=i,this.m_total=e,this.setClipIndex(0)}}getColorAt(t){if(t>=0&&t<this.m_total)return this.m_colors[t]}setColorAt(t,e){t>=0&&t<this.m_total&&null!=e&&this.m_colors[t].copyFrom(e)}setClipIndex(t){t>=0&&t<this.m_total&&(this.m_index=t,this.m_lb.setColor(this.m_colors[t]))}setCircleClipIndex(t){t%=this.m_total,t+=this.m_total,t%=this.m_total,this.setClipIndex(t)}getClipIndex(){return this.m_index}getClipsTotal(){return this.m_total}setLabelClipIndex(t){this.m_lb.setClipIndex(t)}getLabelClipIndex(){return this.m_lb.getClipIndex()}setLabelCircleClipIndex(t){this.m_lb.setCircleClipIndex(t)}getLabelClipsTotal(){return this.m_lb.getClipsTotal()}getColors(){return this.m_colors}getClipWidth(){return this.m_lb.getClipHeight()}getClipHeight(){return this.m_lb.getClipWidth()}copyTransformFrom(t){if(null!=t){let e=t.getScaleX(),i=t.getScaleY(),s=t.getRotation();this.setScaleXY(e,i),this.setRotation(s),t.getPosition(this.m_v0),this.setPosition(this.m_v0)}}getREntities(){if(null!=this.m_ilb){let t=this.m_lb.getREntities();return t.concat(this.m_ilb.getREntities())}return this.m_lb.getREntities()}getRContainer(){return null}update(){this.m_bounds.reset();let t=this.m_scaleV,e=this.m_lb;e.setRotation(this.m_rotation),e.setScaleXY(t.x,t.y),e.setPosition(this.m_pos),e.update(),this.m_bounds.union(e.getGlobalBounds()),e=this.m_ilb,null!=e&&(e.copyTransformFrom(this.m_lb),e.update(),this.m_bounds.union(e.getGlobalBounds())),this.m_bounds.updateFast()}destroy(){this.m_colors=null,this.m_total=0;let t=this.m_lb;null!=t&&(t.destroy(),t=null),t=this.m_ilb,null!=t&&(t.destroy(),t=null),super.destroy()}}e.ColorClipLabel=n},8875:function(t,e,i){var s,n,l;(function(i,r){n=[],s=r,l="function"===typeof s?s.apply(e,n):s,void 0===l||(t.exports=l)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(_){var i,s,n,l=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,r=/@([^@]*):(\d+):(\d+)\s*$/gi,o=l.exec(_.stack)||r.exec(_.stack),a=o&&o[1]||!1,h=o&&o[2]||!1,m=document.location.href.replace(document.location.hash,""),u=document.getElementsByTagName("script");a===m&&(i=document.documentElement.outerHTML,s=new RegExp("(?:[^\\n]+?\\n){0,"+(h-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),n=i.replace(s,"$1").trim());for(var c=0;c<u.length;c++){if("interactive"===u[c].readyState)return u[c];if(u[c].src===a)return u[c];if(a===m&&u[c].innerHTML&&u[c].innerHTML.trim()===n)return u[c]}return null}}return t}))},"88ee":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("3914"),n=i("bb62"),l=i("85be"),r=i("3f49"),o=i("1dd7"),a=i("eb56"),h=i("ff8d"),m=i("2870"),u=i("39ac"),c=i("f7eb"),_=i("5d8c"),p=i("14e2"),d=i("e9cf"),g=i("ccfe"),f=i("af66"),y=i("3f7d"),C=i("1389"),b=i("dd4e");function x(){return new r.ColorLabel}function v(){return new _.RectTextTip}function E(){return new s.ClipLabel}function S(){return new n.ClipColorLabel}function L(){return new l.ColorClipLabel}function M(){return new o.TextLabel}function T(){return new a.Button}function B(){return new h.FlagButton}function P(){return new u.SelectButtonGroup}function I(t,e,i,s,n,l){return m.ButtonBuilder.createTextButton(t,e,i,s,n,l)}function R(){return new f.UIPanel}function w(){return new g.PromptPanel}function A(t=null,e=null,i=512,s=3){let n=new c.CoUIScene;if(null!=e&&n.initialize(e,i,s),n.uiConfig=t,null!=t){let t=new y.PromptSystem;t.initialize(n),n.prompt=t;let e=new C.TipsSystem;e.initialize(n),n.tips=e;let i=new b.PanelSystem;i.initialize(n),n.panel=i}return n}function F(){return new p.TipInfo}function O(){return new d.UILayout}e.createColorLabel=x,e.createRectTextTip=v,e.createClipLabel=E,e.createClipColorLabel=S,e.createColorClipLabel=L,e.createTextLabel=M,e.createButton=T,e.createFlagButton=B,e.createSelectButtonGroup=P,e.createTextButton=I,e.createUIPanel=R,e.createPromptPanel=w,e.createUIScene=A,e.createTipInfo=F,e.createUILayout=O},ab08:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){}calcRange(t,e=.7,i=.5){i<0?i=0:i>1&&(i=1),e<0?e=0:e>1&&(e=1);let s=t*(1-e),n=i*t,l=n+.5*s;l>t&&(l=t);let r=l-s;return[r,l]}avgLayout(t,e,i,s=-1){if(null!=t&&t.length>0){let n=t.length;switch(n){case 1:let n=.5*(i-e)+e;return[n-.5*t[0]];default:return this.calcAvgMulti(t,e,i,s)}}return null}calcAvgLayout(t,e,i=.7,s=.5){let n=this.calcRange(e,i,s);return this.avgLayout(t,n[0],n[1])}calcAvgFixLayout(t,e,i=10,s=.7,n=.5){let l=this.calcRange(e,s,n);return this.avgLayout(t,l[0],l[1],i)}calcAvgMulti(t,e,i,s=-1){let n=i-e,l=t.length,r=0;for(let a=0;a<l;a++)r+=t[a],s>0&&a>0&&(r+=s);let o=new Array(l);if(o[0]=e,o[l-1]=i-t[l-1],l>2)if(r<n){let e=(n-r)/(l-1);l--;for(let i=1;i<l;i++)o[i]=o[i-1]+t[i-1]+e}else if(s<=0){let e=o[0]+.5*t[0];n=o[l-1]+.5*t[l-1]-e;let i=n/(l-1);e+=i,l--;for(let t=1;t<l;t++)o[t]=e,e+=i}if(r>=n&&s>0){let i=.5*n+e-.5*(r+(l-1)*s);for(let e=0;e<l;e++)o[e]=i,i+=t[e]+s}return o}}e.AxisAlignCalc=s},af66:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("5e13"),n=i("3f49");class l extends s.UIEntityContainer{constructor(){super(),this.m_panelW=100,this.m_panelH=150,this.m_isOpen=!1,this.autoLayout=!0,this.m_openListener=null,this.m_closeListener=null,this.m_panelBuilding=!0}setSize(t,e){this.m_panelW=t,this.m_panelH=e}setBGColor(t){return null==this.m_bgColor&&(this.m_bgColor=CoMaterial.createColor4()),this.m_bgColor.copyFrom(t),null!=this.m_bgLabel&&this.m_bgLabel.setColor(t),this}init(){this.isIniting()&&(null==this.m_bgColor&&(this.m_bgColor=CoMaterial.createColor4()),super.init())}setUIscene(t,e=-1){null==this.m_scene&&null!=t&&(this.m_scene=t,e>=0&&(this.m_rpi=e),this.init())}openThis(){}closeThis(){}setOpenAndLoseListener(t,e){this.m_openListener=t,this.m_closeListener=e}open(t=null,e=-1){this.m_isOpen||(this.isIniting()&&this.init(),null!=t&&(this.m_scene=t),e>=0&&(this.m_rpi=e),this.m_scene.addEntity(this,this.m_rpi),this.m_isOpen=!0,this.setVisible(!0),this.openThis(),this.autoLayout&&(this.addLayoutEvt(),this.layout()),null!=this.m_openListener&&this.m_openListener())}isOpen(){return this.m_isOpen}close(){this.m_isOpen&&(this.m_scene.removeEntity(this),this.m_isOpen=!1,this.setVisible(!1),this.removeLayoutEvt(),this.closeThis(),null!=this.m_closeListener&&this.m_closeListener())}destroy(){super.destroy(),this.m_panelBuilding=!0,null!=this.m_bgLabel&&(this.m_bgLabel.destroy(),this.m_bgLabel=null),this.m_openListener=null,this.m_closeListener=null}buildPanel(t,e){}updateScene(){let t=this.getScene();if(null!=t&&this.m_panelBuilding&&null==this.m_bgLabel){this.m_panelBuilding=!1;let t=this.m_panelW,e=this.m_panelH,i=this.createBG(t,e);this.buildPanel(t,e),this.addEntity(i),this.setVisible(this.m_isOpen),this.m_isOpen&&(this.addLayoutEvt(),this.layout())}}addLayoutEvt(){if(this.autoLayout){let t=this.getScene();if(null!=t){let e=CoRScene.EventBase;t.addEventListener(e.RESIZE,this,this.resize)}}}removeLayoutEvt(){if(this.autoLayout){let t=this.getScene();if(null!=t){let e=CoRScene.EventBase;t.removeEventListener(e.RESIZE,this,this.resize)}}}createBG(t,e){let i=new n.ColorLabel;return i.depthTest=!0,i.initialize(t,e),i.setZ(-.1),i.setColor(this.m_bgColor),this.m_bgLabel=i,this.initializeEvent(i.getREntities()[0]),i}initializeEvent(t,e="uiPlane"){const i=CoRScene.MouseEvent;let s=CoRScene.createMouseEvt3DDispatcher();s.currentTarget=this,s.uuid=e,s.addEventListener(i.MOUSE_OVER,this,this.mouseOverListener),s.addEventListener(i.MOUSE_OUT,this,this.mouseOutListener),t.setEvtDispatcher(s),t.mouseEnabled=!0}mouseOverListener(t){}mouseOutListener(t){}resize(t){this.layout()}layout(){let t=this.getScene();if(null!=t){this.update();let e=t.getRect(),i=Math.round(e.x+.5*(e.width-this.getWidth())),s=Math.round(e.y+.5*(e.height-this.getHeight()));this.setXY(i,s),this.update()}}}e.UIPanel=l},b0fb:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.m_sc=null,this.m_parent=null,this.m_rotation=0,this.m_visible=!0,this.m_entities=[],this.m_width=0,this.m_height=0,this.m_v0=null,this.m_bounds=null,this.m_rcontainer=null,this.premultiplyAlpha=!1,this.transparent=!1,this.info=null,this.depthTest=!1}init(){this.isIniting()&&(this.m_pos=CoMath.createVec3(),this.m_scaleV=CoMath.createVec3(1,1,1),this.m_v0=CoMath.createVec3(),this.m_bounds=CoMath.createAABB())}isIniting(){return null==this.m_bounds}createMaterial(t=null){let e=CoMaterial.createDefaultMaterial();return e.premultiplyAlpha=this.premultiplyAlpha,null!=t&&e.setTextureList([t]),e.initializeByCodeBuf(null!=t),e}applyRST(t){const e=CoRScene.RendererState;this.transparent?this.premultiplyAlpha?t.setRenderState(e.BACK_ALPHA_ADD_ALWAYS_STATE):this.depthTest?t.setRenderState(e.BACK_TRANSPARENT_STATE):t.setRenderState(e.BACK_TRANSPARENT_ALWAYS_STATE):this.depthTest?t.setRenderState(e.NORMAL_STATE):t.setRenderState(e.BACK_NORMAL_ALWAYS_STATE)}createVS(t,e,i,s){let n=t,l=e,r=t+i,o=e+s,a=0;return[n,l,a,r,l,a,r,o,a,n,o,a]}updateScene(){}updateParent(){}__$setScene(t){this.m_sc!=t&&(this.m_sc=t,this.updateScene())}getScene(){return this.m_sc}setParent(t){return t!=this&&(this.m_parent=t,this.updateParent()),this}getParent(){return this.m_parent}getGlobalBounds(){return this.m_bounds}setVisible(t){this.m_visible=t;let e=this.m_entities;for(let i=0;i<e.length;++i)e[i].setVisible(t);null!=this.m_rcontainer&&this.m_rcontainer.setVisible(t)}isVisible(){return this.m_visible}getWidth(){return this.m_bounds.getWidth()}getHeight(){return this.m_bounds.getHeight()}setPosition(t){this.m_pos.copyFrom(t)}setX(t){this.m_pos.x=t}setY(t){this.m_pos.y=t}setZ(t){this.m_pos.z=t}getX(){return this.m_pos.x}getY(){return this.m_pos.y}getZ(){return this.m_pos.z}setXY(t,e){this.m_pos.x=t,this.m_pos.y=e}getPosition(t){return t.copyFrom(this.m_pos),t}setRotation(t){this.m_rotation=t}getRotation(){return this.m_rotation}setScaleXYZ(t,e,i){this.m_scaleV.setXYZ(t,e,i)}setScaleXY(t,e){this.setScaleXYZ(t,e,1)}setScaleX(t){this.m_scaleV.x=t}setScaleY(t){this.m_scaleV.y=t}getScaleX(){return this.m_scaleV.x}getScaleY(){return this.m_scaleV.y}copyTransformFrom(t){if(null!=t){let e=t.getScaleX(),i=t.getScaleY(),s=t.getRotation();this.setScaleXY(e,i),this.setRotation(s),t.getPosition(this.m_v0),this.setPosition(this.m_v0)}}getREntities(){return this.m_entities.slice(0)}getRContainer(){return this.m_rcontainer}updateEntity(t){t.setPosition(this.m_pos),t.setScale3(this.m_scaleV),t.setRotationXYZ(0,0,this.m_rotation),t.update(),this.m_bounds.union(t.getGlobalBounds())}update(){let t=this.m_entities,e=this.m_bounds;this.m_bounds.reset();for(let i=0;i<t.length;++i)this.updateEntity(t[i]);null!=this.m_rcontainer&&this.updateEntity(this.m_rcontainer),e.updateFast()}destroy(){let t=this.m_sc;null!=t&&t.removeEntity(this),this.m_rcontainer=null,this.m_sc=null,this.m_parent=null,this.m_bounds=null;let e=this.m_entities;for(let i=0;i<e.length;++i)e[i].destroy();e=[]}}e.UIEntityBase=s},b997:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("10ee");class n extends s.LayouterBase{constructor(){super(),this.m_offsetvs=[]}update(t){const e=this.m_entities,i=e.length;let s=CoMath.createVec3();for(let n=0;n<i;++n)e[n].getPosition(s).addBy(this.m_offsetV),e[n].setPosition(s),e[n].update()}initEntityLayout(t,e){let i=CoMath.createVec3();t.getPosition(i),i.y=e.height-i.y,this.m_offsetvs.push(i)}destroy(){this.m_offsetvs=null,super.destroy()}}e.FreeLayouter=n},bb62:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("67d8");class n extends s.ClipLabelBase{constructor(){super(...arguments),this.m_colors=null,this.m_material=null,this.m_fixSize=!0,this.m_hasTex=!1}createMesh(t,e){let i=new Uint16Array([0,1,2,0,2,3]),s=new Float32Array(this.createVS(0,0,this.m_width,this.m_height)),n=CoMesh.createRawMesh();if(n.reset(),n.setIVS(i),n.addFloat32Data(s,3),""!=e&&null!=t){let i=t.getTexObjFromAtlas(e),s=new Float32Array(i.uvs);n.addFloat32Data(s,2)}return n.initialize(),n}hasTexture(){return this.m_hasTex}initialize(t,e,i){if(this.isIniting()&&i>0){this.init(),this.m_hasTex=!1;let s=null;if(""!=e&&null!=t){let i=t.getTexObjFromAtlas(e);this.m_fixSize&&(this.m_width=i.getWidth(),this.m_height=i.getHeight()),this.m_hasTex=!0,s=i.texture}let n=this.createMaterial(s),l=this.createMesh(t,e),r=CoEntity.createDisplayEntity();r.setMaterial(n),r.setMesh(l),this.m_entities.push(r),this.m_material=n;let o=new Array(i);for(let t=0;t<i;++t)o[t]=CoMaterial.createColor4();this.m_colors=o,this.m_total=i,this.setClipIndex(0)}}initializeWithoutTex(t,e,i){this.m_width=t,this.m_height=e,this.m_fixSize=!1,this.initialize(null,"",i)}initializeWithSize(t,e,i,s,n){t>0&&e>0&&(this.m_width=t,this.m_height=e,this.m_fixSize=!1,this.initialize(i,s,n))}initializeWithLable(t){if(this.isIniting()&&null!=t&&t!=this){if(t.getClipsTotal()<1)throw Error("Error: srcLable.getClipsTotal() < 1");let e=t.getREntities();for(let i=0;i<e.length;++i){let s=e[i],n=s.getMesh(),l=s.getMaterial().getTextureAt(0),r=this.m_total=t.getClipsTotal(),o=t.getColors(),a=new Array(r);for(let t=0;t<r;++t)a[t]=CoMaterial.createColor4(),a[t].copyFrom(o[t]);this.m_colors=a,this.m_width=t.getWidth(),this.m_height=t.getHeight();let h=this.createMaterial(l),m=CoEntity.createDisplayEntity();m.setMaterial(h),m.setMesh(n),this.m_entities.push(m),null==this.m_material&&(this.m_material=h)}this.setClipIndex(0)}}displaceFromLable(t){if(null!=t&&t!=this&&t.getClipsTotal()<1)throw Error("Error: srcLable.getClipsTotal() < 1")}getColorAt(t){if(t>=0&&t<this.m_total)return this.m_colors[t]}setColorAt(t,e){t>=0&&t<this.m_total&&null!=e&&this.m_colors[t].copyFrom(e)}setColors(t){if(null!=t){let e=this.m_colors,i=t.length;i>e.length&&(i=e.length);for(let s=0;s<i;++s)e[s].copyFrom(t[s])}}setClipIndex(t){t>=0&&t<this.m_total&&(this.m_index=t,this.m_material.setColor(this.m_colors[t]))}getColors(){return this.m_colors}}e.ClipColorLabel=n},ccfe:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("1dd7"),n=i("af66"),l=i("2870"),r=i("ab08");class o extends n.UIPanel{constructor(){super(),this.m_promptLabel=null,this.m_prompt="Hi,Prompt Panel.",this.m_btnW=90,this.m_btnH=50,this.m_confirmFunc=null,this.m_cancelFunc=null,this.m_cancelBtnVis=!0,this.marginWidth=70,this.marginXFactor=.5,this.marginYFactor=.6,this.m_alignCalc=new r.AxisAlignCalc}initialize(t,e,i,s,n,l,r="Confirm",o="Cancel"){this.isIniting()&&(this.init(),this.m_scene=t,this.m_rpi=e,this.m_panelW=i,this.m_panelH=s,this.m_btnW=n,this.m_btnH=l,this.m_confirmNS=r,this.m_cancelNS=o,null==this.m_bgColor&&(this.m_bgColor=CoMaterial.createColor4()))}applyConfirmButton(){this.m_cancelBtnVis=!1;let t=this.m_cancelBtn;null==t||t.isVisible()||(this.m_cancelBtn.setVisible(!1),null!=this.m_confirmBtn&&this.isOpen()&&(this.layoutItems(),this.layout()))}applyAllButtons(){this.m_cancelBtnVis=!0,null!=this.m_cancelBtn&&this.m_cancelBtn.setVisible(!0)}setPrompt(t){if(""!=t&&this.m_prompt!=t){this.m_prompt=t;let e=this.m_promptLabel;if(null!=e){e.setText(t);let i=.5*(this.m_panelW-e.getWidth());e.setX(i),e.update(),null!=this.m_confirmBtn&&this.isOpen()&&(this.layoutItems(),this.layout())}}}setPromptTextColor(t){let e=this.m_promptLabel;null!=e&&e.setColor(t)}setListener(t,e){this.m_confirmFunc=t,this.m_cancelFunc=e}destroy(){super.destroy(),this.m_confirmFunc=null,this.m_cancelFunc=null,null!=this.m_confirmBtn&&(this.m_confirmBtn.destroy(),this.m_cancelBtn.destroy(),this.m_confirmBtn=null,this.m_cancelBtn=null)}buildPanel(t,e){this.buildItems()}buildItems(){if(null==this.m_confirmBtn){let t=this.getScene(),e=t.transparentTexAtlas,i=CoMaterial.createColor4,n=this.m_scene.uiConfig,r=n.getUIGlobalColor(),o=n.getUIPanelCfgByName("promptPanel"),a=o.btnKeys,h=o.btnTextFontFormat,m=o.textFontFormat,u=new s.TextLabel;u.depthTest=!0,u.transparent=!0,u.premultiplyAlpha=!0,u.initialize(this.m_prompt,t,m.fontSize);let c=i();c.fromBytesArray3(m.fontColor),u.setColor(c),this.m_promptLabel=u;CoRScene.MouseEvent;let _={text:this.m_confirmNS,textColor:i(),fontSize:h.fontSize,font:""};_.textColor.fromBytesArray3(h.fontColor);let p=[i(),i(),i(),i()];n.applyButtonColor(p,r.button.light);let d=l.ButtonBuilder,g=d.createTextButton(this.m_btnW,this.m_btnH,a[0],e,_,p);this.m_confirmBtn=g,_.text=this.m_cancelNS;let f=d.createTextButton(this.m_btnW,this.m_btnH,a[1],e,_,p);this.m_cancelBtn=f,this.addEntity(f),this.addEntity(g),this.addEntity(u)}}updateBgSize(){let t=this.m_panelW,e=this.m_promptLabel;e.update();let i=this.m_confirmBtn;i.update();let s=this.m_cancelBtn;s.update();let n=s.isVisible()?s.getWidth():0,l=i.getWidth()+n;n=l+Math.round(.2*l)+this.marginWidth;let r=e.getWidth()+this.marginWidth;r=n>r?n:r,t=this.m_panelW=r;let o=this.m_bgLabel;Math.abs(o.getWidth()-t)>.01&&(o.setScaleX(1),o.update(),r=o.getWidth(),o.setScaleX(t/r),o.update())}layoutItems(){this.m_cancelBtn.setVisible(this.m_cancelBtnVis),this.updateBgSize();let t=this.m_panelW,e=this.m_promptLabel,i=[this.m_btnH,e.getHeight()],s=this.m_alignCalc.calcAvgFixLayout(i,this.m_panelH,15,this.marginYFactor,.5),n=.5*(t-e.getWidth());e.setXY(n,s[1]),e.update(),this.m_cancelBtn.isVisible()?this.layoutButtons(n,s[0]):this.layoutOnlyConfirm(n,s[0])}layoutButtons(t,e){let i=[this.m_btnW,this.m_btnW],s=this.m_alignCalc.calcAvgFixLayout(i,this.m_panelW,10,this.marginXFactor,.5),n=this.m_confirmBtn,l=this.m_cancelBtn;n.setXY(s[0],e),n.update(),l.setXY(s[1],e),l.update()}layoutOnlyConfirm(t,e){let i=[this.m_btnW],s=this.m_alignCalc.calcAvgFixLayout(i,this.m_panelW,10,this.marginXFactor,.5),n=this.m_confirmBtn;n.setXY(s[0],e),n.update()}openThis(){let t=CoRScene.MouseEvent;null!=this.m_scene&&(this.m_scene.addEventListener(t.MOUSE_DOWN,this,this.stMouseDownListener),this.m_confirmBtn.addEventListener(t.MOUSE_UP,this,this.btnMouseUpListener),this.m_cancelBtn.addEventListener(t.MOUSE_UP,this,this.btnMouseUpListener),this.layoutItems())}closeThis(){this.m_cancelBtnVis=!0;let t=CoRScene.MouseEvent;null!=this.m_scene&&(this.m_scene.removeEventListener(t.MOUSE_DOWN,this,this.stMouseDownListener),this.m_confirmBtn.removeEventListener(t.MOUSE_UP,this,this.btnMouseUpListener),this.m_cancelBtn.removeEventListener(t.MOUSE_UP,this,this.btnMouseUpListener))}stMouseDownListener(t){let e=t.mouseX,i=t.mouseY,s=this.m_v0;s.setXYZ(e,i,0),this.globalToLocal(s),(s.x<0||s.x>this.m_panelW||s.y<0||s.y>this.m_panelH)&&this.close()}btnMouseUpListener(t){let e=t.uuid;switch(e){case"confirm":this.close(),null!=this.m_confirmFunc&&this.m_confirmFunc();break;case"cancel":this.close(),null!=this.m_cancelFunc&&this.m_cancelFunc();break;default:break}}}e.PromptPanel=o},d619:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("10ee");class n extends s.LayouterBase{constructor(){super(),this.m_offsetvs=[]}update(t){const e=this.m_entities,i=e.length;let s=CoMath.createVec3();for(let n=0;n<i;++n)s.copyFrom(this.m_offsetvs[n]),s.y=t.height-s.y,s.addBy(this.m_offsetV),e[n].setPosition(s),e[n].update()}initEntityLayout(t,e){let i=CoMath.createVec3();t.getPosition(i),i.y=e.height-i.y,this.m_offsetvs.push(i)}destroy(){this.m_offsetvs=null,super.destroy()}}e.LeftTopLayouter=n},dd4e:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("5870");class n{constructor(){this.m_colorPickPanel=new s.ColorPickPanel,this.m_curPanel=null}initialize(t,e=1){null==this.m_uiscene&&(this.m_uiscene=t,this.m_colorPickPanel.setBGColor(CoMaterial.createColor4(.4,.4,.4)),this.m_colorPickPanel.initialize(t,e,260,260,3))}getPanelByName(t){switch(t){case"colorPickPanel":return this.m_colorPickPanel;default:return null}}setXY(t,e,i,s=0){let n=this.getPanelByName(t);null!=n&&n.setXY(e,i)}openPanel(t,e=0){let i=this.getPanelByName(t);null!=i&&i.open()}closePanel(t,e=0){let i=this.getPanelByName(t);null!=i&&i.close()}getPanel(t,e=0){return this.getPanelByName(t)}}e.PanelSystem=n},e05d:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("10ee");class n extends s.LayouterBase{constructor(){super(),this.m_offsetvs=[]}update(t){const e=this.m_entities,i=e.length;let s=CoMath.createVec3();for(let n=0;n<i;++n)s.copyFrom(this.m_offsetvs[n]),s.x=t.width-s.x,s.y=t.height-s.y,s.addBy(this.m_offsetV),e[n].setPosition(s),e[n].update()}initEntityLayout(t,e){let i=CoMath.createVec3();t.getPosition(i),i.x=e.width-i.x,i.y=e.height-i.y,this.m_offsetvs.push(i)}destroy(){this.m_offsetvs=null,super.destroy()}}e.RightTopLayouter=n},e9cf:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("d619"),n=i("e05d"),l=i("8351"),r=i("b997");class o{constructor(){this.m_layouters=[],this.m_rect=null}createFreeLayouter(){let t=new r.FreeLayouter;return this.addLayouter(t),t}createLeftTopLayouter(){let t=new s.LeftTopLayouter;return this.addLayouter(t),t}createRightTopLayouter(){let t=new n.RightTopLayouter;return this.addLayouter(t),t}createRightBottomLayouter(){let t=new l.RightBottomLayouter;return this.addLayouter(t),t}initialize(t){null!=t&&null==this.m_rect&&(t.update(),this.m_rect=CoMath.createAABB2D(t.x,t.y,t.width,t.height))}getAreaRect(){return this.m_rect}addLayouter(t){if(null!=t){let e=0,i=this.m_layouters;for(;e<i.length;++e)if(i[e]==t)break;e>=i.length&&(i.push(t),t.initLayout(this.m_rect))}}removeLayouter(t){if(null!=t){let e=0,i=this.m_layouters;for(;e<i.length;++e)if(i[e]==t){i.splice(e,1);break}}}update(t){this.m_rect.copyFrom(t);for(let e=0;e<this.m_layouters.length;++e)this.m_layouters[e].update(t)}destroy(){}}e.UILayout=o},eb56:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("3914"),n=i("b0fb");class l extends n.UIEntityBase{constructor(){super(),this.m_enabled=!0,this.m_lb=null,this.m_lbs=[],this.uuid="btn"}addLabel(t){this.m_lbs.push(t)}enable(){return null!=this.m_dp&&(this.m_dp.enabled=!0),this.m_enabled=!0,this}disable(){return null!=this.m_dp&&(this.m_dp.enabled=!1),this.m_enabled=!1,this}isEnabled(){return this.m_enabled}setMouseEnabled(t){null!=this.m_entities&&(this.m_entities[0].mouseEnabled=t)}isMouseEnabled(){return null!=this.m_entities&&this.m_entities[0].mouseEnabled}initialize(t,e=null){if(this.isIniting()&&null!=t&&null!=e){if(this.init(),4!=e.length)throw Error("Error: idnsList.length != 4");let i=new s.ClipLabel;i.initialize(t,e),this.m_lb=i,this.initializeEvent(),this.m_lb.setClipIndex(0)}return this}initializeWithLable(t){if(this.isIniting()){if(this.init(),t.getClipsTotal()<1)throw Error("Error: lable.getClipsTotal() < 1");this.m_lb=t,this.initializeEvent(),this.m_lb.setClipIndex(0)}return this}getLable(){return this.m_lb}initializeEvent(){if(null==this.m_dp){const t=CoRScene.MouseEvent;let e=CoRScene.createMouseEvt3DDispatcher();e.currentTarget=this,e.uuid=this.uuid,e.enabled=this.m_enabled,e.addEventListener(t.MOUSE_DOWN,this,this.mouseDownListener),e.addEventListener(t.MOUSE_UP,this,this.mouseUpListener),e.addEventListener(t.MOUSE_OVER,this,this.mouseOverListener),e.addEventListener(t.MOUSE_OUT,this,this.mouseOutListener),this.m_lb.getREntities()[0].setEvtDispatcher(e),this.m_dp=e}this.m_entities=this.m_lb.getREntities().slice(0),this.m_entities[0].mouseEnabled=!0}setVisible(t){super.setVisible(t);let e=this.m_lbs;for(let i=0;i<e.length;++i)e[i].setVisible(t)}addEventListener(t,e,i,s=!0,n=!1){return this.m_dp.addEventListener(t,e,i,s,n),this}removeEventListener(t,e,i){return this.m_dp.removeEventListener(t,e,i),this}mouseOverListener(t){if(this.m_enabled){this.m_lb.setClipIndex(1);let t=this.m_lbs;if(t.length>0)for(let e=0;e<t.length;++e)t[e].setClipIndex(1)}}mouseOutListener(t){if(this.m_enabled){this.m_lb.setClipIndex(0);let t=this.m_lbs;if(t.length>0)for(let e=0;e<t.length;++e)t[e].setClipIndex(0)}}mouseDownListener(t){if(this.m_enabled){this.m_lb.setClipIndex(2);let t=this.m_lbs;if(t.length>0)for(let e=0;e<t.length;++e)t[e].setClipIndex(2)}}mouseUpListener(t){if(this.m_enabled){this.m_lb.setClipIndex(3);let t=this.m_lbs;if(t.length>0)for(let e=0;e<t.length;++e)t[e].setClipIndex(3)}}setClipIndex(t){return this.m_lb.setClipIndex(t),this}copyTransformFrom(t){if(null!=t){let e=t.getScaleX(),i=t.getScaleY(),s=t.getRotation();this.setScaleXY(e,i),this.setRotation(s),t.getPosition(this.m_v0),this.setPosition(this.m_v0)}}getREntities(){let t=this.m_lb.getREntities(),e=this.m_lbs;if(e.length>0){for(let i=0;i<e.length;++i)t=t.concat(e[i].getREntities());return t}return t}getRContainer(){return null}update(){this.m_bounds.reset();let t=this.m_scaleV,e=this.m_lb;e.setRotation(this.m_rotation),e.setScaleXY(t.x,t.y),e.setPosition(this.m_pos),e.update(),this.m_bounds.union(e.getGlobalBounds());let i=this.m_lbs;if(i.length>0)for(let s=0;s<i.length;++s)i[s].copyTransformFrom(this.m_lb),i[s].update(),this.m_bounds.union(i[s].getGlobalBounds());this.m_bounds.updateFast()}destroy(){let t=this.m_lb;null!=t&&(t.destroy(),t=null);let e=this.m_lbs;if(e.length>0){for(let t=0;t<e.length;++t)e[t].destroy();this.m_lbs=[]}null!=this.m_dp&&(this.m_dp.destroy(),this.m_dp=null),super.destroy()}}e.Button=l},f7eb:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("e9cf");class n{constructor(){this.texAtlas=null,this.transparentTexAtlas=null,this.layout=new s.UILayout,this.prompt=null,this.tips=null,this.panel=null,this.uiConfig=null,this.keyboardInteraction=null,this.texAtlasNearestFilter=!0}initialize(t=null,e=1024,i=3){if(null==this.m_crscene){this.m_crscene=null!=t?t:CoRScene.getRendererScene(),t=this.m_crscene;let s=this.m_crscene.getStage3D();t.addEventListener(CoRScene.EventBase.RESIZE,this,this.resizeHandle);let n=CoRScene.createRendererSceneParam();n.cameraPerspectiveEnabled=!1,n.setAttriAlpha(!1),n.setCamProject(45,.1,3e3),n.setCamPosition(0,0,1500);let l=t.createSubScene(n,i,!0);l.enableMouseEvent(!0);let r=this;r.rscene=l;let o=r.texAtlas=CoTexture.createCanvasTexAtlas(),a=r.transparentTexAtlas=CoTexture.createCanvasTexAtlas();o.initialize(t,e,e,CoMaterial.createColor4(1,1,1,1),!1,this.texAtlasNearestFilter),o.getTexture().premultiplyAlpha=!1,a.initialize(t,e,e,CoMaterial.createColor4(1,1,1,0),!0,this.texAtlasNearestFilter),a.getTexture().premultiplyAlpha=!0,this.m_rstage=s;let h=this.rscene.getCamera();h.translationXYZ(s.stageHalfWidth,s.stageHalfHeight,1500),h.update();let m=this.getStage();this.m_stageRect=CoMath.createAABB2D(0,0,m.stageWidth,m.stageHeight),this.layout.initialize(this.m_stageRect)}}addEventListener(t,e,i,s=!0,n=!1){return this.m_rstage.addEventListener(t,e,i,s,n),this}removeEventListener(t,e,i){return this.m_rstage.removeEventListener(t,e,i),this}getStage(){return this.rscene.getStage3D()}addEntity(t,e=0){if(null!=t){t.__$setScene(this),t.update();let i=t.getRContainer();null!=i&&this.rscene.addContainer(i,e);let s=t.getREntities();for(let t=0;t<s.length;++t)this.rscene.addEntity(s[t],e,!0)}}removeEntity(t){if(null!=t){let e=this.rscene,i=t.getRContainer();null!=i&&e.removeContainer(i);let s=t.getREntities();for(let t=0;t<s.length;++t)e.removeEntity(s[t]);t.__$setScene(null)}}getRect(){return this.m_stageRect}resize(){let t=this.m_rstage,e=this.rscene.getCamera();e.translationXYZ(t.stageHalfWidth,t.stageHalfHeight,1500),e.update(),this.m_stageRect.setTo(0,0,t.stageWidth,t.stageHeight),this.updateLayout()}updateLayout(){this.layout.update(this.m_stageRect)}run(){null!=this.rscene&&this.rscene.run()}resizeHandle(t){this.resize()}}e.CoUIScene=n},fae3:function(t,e,i){"use strict";i.r(e);i("1eb2");var s=i("88ee");for(var n in s)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(n)},ff8d:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("eb56"),n=i("3914"),l=i("85be");class r extends s.Button{constructor(){super(),this.m_flagLb=null,this.m_pw=32,this.m_ph=32,this.m_borderWidth=4,this.m_dis=4,this.uuid="flagBtn"}initializeWithSize(t,e=32,i=32,s=4,n=4){return this.isIniting()&&null!=t&&(this.m_pw=e,this.m_ph=i,this.m_borderWidth=s,this.m_dis=n,this.m_selectDispatcher=CoRScene.createEventBaseDispatcher(),this.m_currEvent=CoRScene.createSelectionEvent(),this.createFlagBtn(t)),this}addEventListener(t,e,i,s=!0,n=!1){return t==CoRScene.SelectionEvent.SELECT?this.m_selectDispatcher.addEventListener(t,e,i,s,n):super.addEventListener(t,e,i,s,n),this}removeEventListener(t,e,i){return t==CoRScene.SelectionEvent.SELECT?this.m_selectDispatcher.removeEventListener(t,e,i):super.removeEventListener(t,e,i),this}createFlagBtn(t){let e=t,i=CoMaterial.createColor4(.7,.7,.7),s=CoMaterial.createColor4(.3,.3,.3),r=this.createFlagImg(e,i,s);e.addImageToAtlas("flagBtn_01",r),i=CoMaterial.createColor4(.7,.7,.7),s=CoMaterial.createColor4(.3,.3,.3);let o=CoMaterial.createColor4(1,1,1);r=this.createFlagImg(e,i,s,o,this.m_dis),e.addImageToAtlas("flagBtn_02",r);let a=["flagBtn_01","flagBtn_02"],h=new n.ClipLabel;h.initialize(e,a);let m=new l.ColorClipLabel;m.initialize(h,4),m.getColorAt(0).setRGB3f(.8,.8,.8),m.getColorAt(1).setRGB3f(0,1,.2),m.getColorAt(2).setRGB3f(1,.2,1),m.setLabelClipIndex(0),this.m_flagLb=h,this.initializeWithLable(m)}sendSelectionEvt(){this.m_selectDispatcher.uuid=this.uuid,this.m_currEvent.target=this,this.m_currEvent.type=CoRScene.SelectionEvent.SELECT,this.m_currEvent.flag=this.getFlag(),this.m_currEvent.phase=1,this.m_selectDispatcher.dispatchEvt(this.m_currEvent),this.m_currEvent.target=null}mouseUpListener(t){this.isEnabled()&&(super.mouseUpListener(t),this.selectListener())}setFlag(t,e=!1){this.m_flagLb.setClipIndex(t?1:0),e&&this.sendSelectionEvt()}getFlag(){return 1==this.m_flagLb.getClipIndex()}selectListener(){1==this.m_flagLb.getClipIndex()?this.m_flagLb.setClipIndex(0):this.m_flagLb.setClipIndex(1),this.sendSelectionEvt()}createFlagImg(t,e,i,s=null,n=2){let l=this.m_pw,r=this.m_ph,o=this.m_borderWidth,a=t.createCanvas(l,r,e,!1),h=a.getContext("2d");return h.fillStyle=i.getCSSDecRGBAColor(),h.fillRect(o,o,l-2*o,r-2*o-1),null!=s&&(h.fillStyle=s.getCSSDecRGBAColor(),h.fillRect(o+n,o+n,l-2*(o+n),r-2*(o+n)-1)),a}destroy(){this.m_flagLb=null,super.destroy()}}e.FlagButton=r}})}));