(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["CoMesh"]=e():t["CoMesh"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(i,r,function(e){return t[e]}.bind(null,r));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s="fae3")}({"0f76":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){this.m_bufSortFormat=0,this.vbWholeDataEnabled=!1,this.wireframe=!1,this.polyhedral=!0,this.transMatrix=null}createIVSBYSize(t){return t>65535?new Uint32Array(t):new Uint16Array(t)}createIVSByArray(t){return t.length>65535?new Uint32Array(t):new Uint16Array(t)}setBufSortFormat(t){this.m_bufSortFormat=t}applyMaterial(t,e=!1){e=e||null!=t.getTextureAt(0),t.initializeByCodeBuf(e),this.m_bufSortFormat=t.getBufSortFormat()}createMesh(){let t=CoRScene.createRawMesh();return t.setTransformMatrix(this.transMatrix),t.setBufSortFormat(this.m_bufSortFormat),t.reset(),this.setMeshData(t),t.vbWholeDataEnabled=this.vbWholeDataEnabled,t.wireframe=this.wireframe,t.setPolyhedral(this.polyhedral),t.initialize(),t.toElementsTriangles(),this.transMatrix=null,this.m_bufSortFormat=0,t}setMeshData(t){}}e.MeshBuilder=i},"159a":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(s("5282")),a=s("0f76");class n extends a.MeshBuilder{constructor(){super(),this.radius=30,this.height=100,this.longitudeNumSegments=2,this.alignYRatio=-.5,this.inverseUV=!1,this.uScale=1,this.vScale=1}create(t,e,s,i=-.5){return this.radius=t,this.height=e,this.longitudeNumSegments=s,this.alignYRatio=i,this.createMesh()}setMeshData(t){let e=this.radius,s=this.height,i=this.longitudeNumSegments,a=this.alignYRatio;e<.01&&(e=.01),i<2&&(i=2);let n=2,l=1,h=0,u=0,o=0,c=0,m=0;e=Math.abs(e),s=Math.abs(s);let d=a*s,f=new r.default(0,d,0,u),_=[],v=[];v.push([]);let p=v[0];for(f.u=.5,f.v=.5,h=0;h<1;++h)f.index=u,++u,p.push(f.cloneVertex()),_.push(p[h]);m=d;let y=.499;for(;l<n;++l){o=Math.PI*l/n,f.y=m,v.push([]);let t=v[l];for(h=0;h<i;++h)o=2*Math.PI*h/i,c=Math.sin(o),m=Math.cos(o),f.x=c*e,f.z=m*e,f.index=u,++u,c*=y,m*=y,f.u=.5+c,f.v=.5+m,t.push(f.cloneVertex()),_.push(t[h]);t.push(t[0])}v.push([]);let g=v[v.length-1],S=v[v.length-2];for(h=0;h<i;++h)g.push(S[h].cloneVertex()),g[h].index=u,++u,_.push(g[h]);g.push(g[0]),f.x=0,f.y=d+s,f.z=0,f.u=.5,f.v=.5,v.push([]);let x=v[v.length-1];for(h=0;h<i;++h)f.index=u,++u,x.push(f.cloneVertex()),_.push(x[h]);x.push(x[0]);let M=null,b=[];for(l=1,n+=1;l<=n;++l){let t=v[l-1],e=v[l];for(h=1;h<=i;++h)1==l?(b.push(t[0].index),b.push(e[h].index),b.push(e[h-1].index)):l==n&&(b.push(t[h].index),b.push(e[h].index),b.push(t[h-1].index))}let V=_.length,w=new Float32Array(3*V);for(l=0,h=0;h<V;++h)M=_[h],w[l]=M.x,w[l+1]=M.y,w[l+2]=M.z,l+=3;let F=new Uint16Array(b);if(t.addFloat32Data(w,3),t.isUVSEnabled()){let e=new Float32Array(2*V);for(l=0,h=0;h<V;++h)M=_[h],e[l]=M.u,e[l+1]=M.v,l+=2;t.addFloat32Data(e,2)}if(t.isNVSEnabled()){let e=new Float32Array(3*V),s=F.length/3;CoAGeom.SurfaceNormal.ClacTrisNormal(w,w.length,s,F,e),t.addFloat32Data(e,3)}t.setIVS(F)}}e.ConeMeshBuilder=n},"1eb2":function(t,e,s){"use strict";if("undefined"!==typeof window){var i=window.document.currentScript,r=s("8875");i=r(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:r});var a=i&&i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);a&&(s.p=a[1])}},"4b06":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s("0f76"),a=i(s("dae3"));class n extends r.MeshBuilder{constructor(){super(),this.geometry=new a.default,this.uScale=1,this.vScale=1}create(t,e,s=20,i=1,r=1,a=-.5){return this.m_radius=t,this.m_long=e,this.m_longitudeNumSegments=s,this.m_latitudeNumSegments=i,this.m_uvType=r,this.m_alignYRatio=a,this.createMesh()}setMeshData(t){let e=this.geometry;e.uScale=this.uScale,e.vScale=this.vScale,e.initialize(this.m_radius,this.m_long,this.m_longitudeNumSegments,this.m_latitudeNumSegments,this.m_uvType,this.m_alignYRatio);let s=t.isNVSEnabled(),i=e.getVS(),r=e.getIVS(),a=e.getUVS(),n=null;if(s&&(n=new Float32Array(i.length)),s){let t=CoMath.createVec3(),s=CoMath.createVec3();for(let r=0;r<=this.m_latitudeNumSegments;++r){e.getCenterAt(r,t);let a=t,l=e.getRangeAt(r),h=i.subarray(l[0],l[1]),u=n.subarray(l[0],l[1]),o=h.length/3,c=0;for(let t=0;t<o;++t)c=3*t,s.setXYZ(h[c],h[c+1],h[c+2]),s.subtractBy(a),s.normalize(),u[c]=s.x,u[c+1]=s.y,u[c+2]=s.z}}t.addFloat32Data(i,3),t.isUVSEnabled()&&t.addFloat32Data(a,2),s&&t.addFloat32Data(n,3),t.setIVS(r),e.reset()}}e.TubeMeshBuilder=n},5282:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t=0,e=0,s=0,i=0){this.x=0,this.y=0,this.z=0,this.u=0,this.v=1,this.nx=0,this.ny=0,this.nz=0,this.index=0,this.x=t,this.y=e,this.z=s,this.index=i}cloneVertex(){let t=new i(this.x,this.y,this.z,this.index);return t.nx=this.nx,t.ny=this.ny,t.nz=this.nz,t.u=this.u,t.v=this.v,t}copyFrom(t){this.x=t.x,this.y=t.y,this.z=t.z,this.u=t.u,this.v=t.v,this.nx=t.nx,this.ny=t.ny,this.nz=t.nz,this.index=t.index}}e.default=i},5565:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(s("dae3")),a=s("0f76");class n extends a.MeshBuilder{constructor(){super(),this.m_ringRadius=100,this.m_axisRadius=50,this.m_uvType=1,this.m_longitudeNumSegments=5,this.m_latitudeNumSegments=10,this.m_alignYRatio=-.5,this.inverseUV=!1,this.uScale=1,this.vScale=1,this.axisType=0,this.geometry=new r.default}create(t=200,e=50,s=30,i=20,r=1,a=-.5){return this.m_ringRadius=t,this.m_axisRadius=e,this.m_longitudeNumSegments=s,this.m_latitudeNumSegments=i,this.m_uvType=r,this.m_alignYRatio=a,this.createMesh()}setMeshData(t){let e=this.m_ringRadius,s=this.m_axisRadius,i=this.m_longitudeNumSegments,r=this.m_latitudeNumSegments,a=this.m_uvType,n=this.m_alignYRatio,l=this.geometry;switch(this.axisType){case 1:l.axisType=2;break;case 2:l.axisType=0;break;default:l.axisType=1;break}l.initialize(s,0,i,r,a,n);let h=t.isNVSEnabled(),u=l.getVS(),o=l.getIVS(),c=l.getUVS(),m=null;h&&(m=new Float32Array(u.length));let d=2*Math.PI,f=0,_=CoMath.createVec3(),v=CoMath.createVec3(),p=CoMath.createMat4();for(let y=0;y<=r;++y){switch(p.identity(),f=d*y/r,this.axisType){case 1:_.x=Math.cos(f)*e,_.z=Math.sin(f)*e,p.rotationY(-f);break;case 2:_.y=Math.cos(f)*e,_.x=Math.sin(f)*e,p.rotationZ(-f);break;default:_.z=Math.cos(f)*e,_.y=Math.sin(f)*e,p.rotationX(-f);break}if(p.setTranslation(_),l.transformAt(y,p),h){let t=_,e=l.getRangeAt(y),s=u.subarray(e[0],e[1]),i=m.subarray(e[0],e[1]),r=s.length/3,a=0;for(let n=0;n<r;++n)a=3*n,v.setXYZ(s[a],s[a+1],s[a+2]),v.subtractBy(t),v.normalize(),i[a]=v.x,i[a+1]=v.y,i[a+2]=v.z}}t.addFloat32Data(u,3),t.isUVSEnabled()&&t.addFloat32Data(c,2),h&&t.addFloat32Data(m,3),t.setIVS(o),l.reset()}}e.TorusMeshBuilder=n},"6fc6":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){this.m_vs=null,this.m_uvs=null,this.m_nvs=null,this.m_ivs=null,this.vtxTotal=0,this.trisNumber=0,this.vtCount=0,this.bounds=null,this.axisType=0}clone(){let t=new i;return t.copyFrom(this),t}getCenterAt(t,e){}transformAt(t,e){}copyFrom(t){let e=new i;null!=t.m_vs&&(null!=this.m_vs?this.m_vs.set(t.m_vs):this.m_vs=t.m_vs.slice(0)),null!=t.m_uvs&&(null!=this.m_uvs?this.m_uvs.set(t.m_uvs):this.m_uvs=t.m_uvs.slice(0)),null!=t.m_nvs&&(null!=this.m_nvs?this.m_nvs.set(t.m_nvs):this.m_nvs=t.m_nvs.slice(0)),null!=t.m_ivs&&(null!=this.m_ivs?this.m_ivs.set(t.m_ivs):this.m_ivs=t.m_ivs.slice(0)),e.vtxTotal=this.vtxTotal,e.trisNumber=this.trisNumber,e.vtCount=this.vtCount,null!=e.bounds&&e.bounds.copyFrom(this.bounds)}getVS(){return this.m_vs}getUVS(){return this.m_uvs}getNVS(){return this.m_nvs}getTVS(){return null}getBTVS(){return null}getCVS(){return null}getIVS(){return this.m_ivs}reset(){this.m_vs=null,this.m_uvs=null,this.m_nvs=null,this.m_ivs=null,this.vtxTotal=0,this.trisNumber=0,this.vtCount=0}}e.default=i},"778d":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s("0f76"),a=i(s("5282"));class n extends r.MeshBuilder{constructor(){super(),this.inverseUV=!1,this.uvScale=1}create(t,e=20,s=20,i=!1){return this.m_radius=t,this.m_longitudeNumSegments=e,this.m_latitudeNumSegments=s,this.m_doubleTriFaceEnabled=i,this.createMesh()}setMeshData(t){let e=this.m_radius,s=this.m_longitudeNumSegments,i=this.m_latitudeNumSegments,r=this.m_doubleTriFaceEnabled;e<1e-4&&(e=1e-4),s<2&&(s=2),i<2&&(i=2),this.m_radius=Math.abs(e),this.m_longitudeNumSegments=s,this.m_latitudeNumSegments=i,(this.m_latitudeNumSegments+1)%2==0&&(this.m_latitudeNumSegments+=1),(this.m_longitudeNumSegments=this.m_latitudeNumSegments)&&(this.m_longitudeNumSegments+=1);let n=1,l=0,h=0,u=0,o=0,c=0,m=0,d=new a.default(0,-this.m_radius,0,h),f=[],_=[];_.push([]);let v=_[0],p=this.inverseUV?1:.5;d.u=d.v=p,d.nx=0,d.ny=-1,d.nz=0,v.push(d.cloneVertex()),f.push(v[0]);let y=0,g=0,S=1/this.m_radius;for(n=0;n<this.m_latitudeNumSegments;++n){o=Math.PI*n/this.m_latitudeNumSegments,c=Math.sin(o),m=Math.cos(o),d.y=-this.m_radius*m,y=this.m_radius*c,g=this.inverseUV?Math.abs(o/Math.PI-.5):.5-Math.abs(o/Math.PI-.5),g*=this.uvScale,_.push([]);let t=_[n];for(l=0;l<this.m_longitudeNumSegments;++l)u=2*Math.PI*l/this.m_longitudeNumSegments,++h,c=Math.sin(u),m=Math.cos(u),d.x=c*y,d.z=m*y,d.index=h,d.u=.5+c*g,d.v=.5+m*g,d.nx=d.x*S,d.ny=d.y*S,d.nz=d.z*S,t.push(d.cloneVertex()),f.push(t[l]);t.push(t[0])}++h,d.index=h,d.x=0,d.y=this.m_radius,d.z=0,d.u=d.v=p,d.nx=0,d.ny=1,d.nz=0,_.push([]);let x=_[this.m_latitudeNumSegments];x.push(d.cloneVertex()),f.push(x[0]);let M=null,b=[],V=null,w=null;for(n=1;n<=this.m_latitudeNumSegments;++n)for(V=_[n-1],w=_[n],l=1;l<=this.m_longitudeNumSegments;++l)1==n?(b.push(V[0].index),b.push(w[l].index),b.push(w[l-1].index)):n==this.m_latitudeNumSegments?(b.push(V[l].index),b.push(w[0].index),b.push(V[l-1].index)):(b.push(V[l].index),b.push(w[l-1].index),b.push(V[l-1].index),b.push(V[l].index),b.push(w[l].index),b.push(w[l-1].index));let F,A=f.length;r?(F=this.createIVSBYSize(2*b.length),F.set(b,0),b.reverse(),F.set(b,b.length)):F=this.createIVSByArray(b);let C=new Float32Array(3*A);for(n=0,l=0;l<A;++l)M=f[l],C[n]=M.x,C[n+1]=M.y,C[n+2]=M.z,n+=3;if(t.addFloat32Data(C,3),t.isUVSEnabled()){let e=new Float32Array(2*A);for(n=0,l=0;l<A;++l)M=f[l],e[n]=M.u,e[n+1]=M.v,n+=2;t.addFloat32Data(e,2)}if(t.isNVSEnabled()){let e=new Float32Array(3*A);for(n=0,l=0;l<A;++l)M=f[l],e[n]=M.nx,e[n+1]=M.ny,e[n+2]=M.nz,n+=3;t.addFloat32Data(e,3)}if(t.isCVSEnabled()){let e=new Float32Array(3*A);for(n=0,l=0;l<A;++l)e[n]=1,e[n+1]=1,e[n+2]=1,n+=3;t.addFloat32Data(e,3)}t.setIVS(F)}}e.SphereMeshBuilder=n},"7f48":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s("d78b"),r=s("ae04"),a=s("159a"),n=s("f07f"),l=s("778d"),h=s("9c83"),u=s("4b06"),o=s("5565"),c=new i.PlaneMeshBuilder;e.plane=c;const m=new r.LineMeshBuilder;e.line=m;const d=new a.ConeMeshBuilder;e.cone=d;const f=new n.BoxMeshBuilder;e.box=f;const _=new l.SphereMeshBuilder;e.sphere=_;const v=new h.CylinderMeshBuilder;e.cylinder=v;const p=new u.TubeMeshBuilder;e.tube=p;const y=new o.TorusMeshBuilder;function g(t,e=null,s=!1){return"undefined"!==typeof CoRScene?CoRScene.createDataMeshFromModel(t,e,s):null}function S(){return"undefined"!==typeof CoRScene?CoRScene.createDataMesh():null}function x(){return"undefined"!==typeof CoRScene?CoRScene.createRawMesh():null}function M(){return"undefined"!==typeof CoRScene?CoRScene.createBoundsMesh():null}e.torus=y,e.createDataMeshFromModel=g,e.createDataMesh=S,e.createRawMesh=x,e.createBoundsMesh=M},8875:function(t,e,s){var i,r,a;(function(s,n){r=[],i=n,a="function"===typeof i?i.apply(e,r):i,void 0===a||(t.exports=a)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(d){var s,i,r,a=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,n=/@([^@]*):(\d+):(\d+)\s*$/gi,l=a.exec(d.stack)||n.exec(d.stack),h=l&&l[1]||!1,u=l&&l[2]||!1,o=document.location.href.replace(document.location.hash,""),c=document.getElementsByTagName("script");h===o&&(s=document.documentElement.outerHTML,i=new RegExp("(?:[^\\n]+?\\n){0,"+(u-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),r=s.replace(i,"$1").trim());for(var m=0;m<c.length;m++){if("interactive"===c[m].readyState)return c[m];if(c[m].src===h)return c[m];if(h===o&&c[m].innerHTML&&c[m].innerHTML.trim()===r)return c[m]}return null}}return t}))},"9c83":function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s("0f76"),a=i(s("5282"));class n extends r.MeshBuilder{constructor(){super(),this.inverseUV=!1,this.uScale=1,this.vScale=1}create(t,e,s=20,i=1,r=-.5){return this.m_radius=t,this.m_height=e,this.m_longitudeNumSegments=s,this.m_uvType=i,this.m_alignYRatio=r,this.createMesh()}setMeshData(t){let e=this.m_radius,s=this.m_height;e<1e-4&&(e=1e-4);let i=this.m_longitudeNumSegments;i<2&&(i=2);let r=3,n=Math.abs(e),l=Math.abs(s),h=1,u=0,o=0,c=0,m=0,d=0,f=this.m_alignYRatio*l,_=new a.default;_.y=f;let v=[],p=[];p.push([]);let y=p[0];for(_.u=.5,_.v=.5,_.nx=0,_.ny=-1,_.nz=0,y.push(_.cloneVertex()),v.push(y[0]);h<r;++h){_.y=f+l*(h-1),p.push([]);let t=p[h];for(u=0;u<i;++u)c=2*Math.PI*u/i,++o,m=Math.sin(c),d=Math.cos(c),_.x=m*n,_.z=d*n,_.index=o,m*=.495,d*=.495,_.u=.5+m,_.v=.5+d,h<2?(_.nx=0,_.ny=-1,_.nz=0):(_.nx=0,_.ny=1,_.nz=0),t.push(_.cloneVertex()),v.push(t[u]);t.push(t[0])}++o,_.index=o,_.x=0,_.y=f+l,_.z=0,_.u=.5,_.v=.5,_.nx=0,_.ny=1,_.nz=0,p.push([]);let g=p[3];g.push(_.cloneVertex()),v.push(g[0]);let S=1/n;for(h=0;h<2;++h){let t=p[h+1];p.push([]);let e=p[p.length-1];for(u=0;u<=i;++u)++o,_.copyFrom(t[u]),_.index=o,this.m_uvType<1?(_.v=h<1?0:this.vScale,_.u=this.uScale*(u/i)):(_.u=h<1?0:this.uScale,_.v=this.vScale*(u/i)),_.ny=0,_.nx=_.x*S,_.nz=_.z*S,e.push(_.cloneVertex()),v.push(e[u])}let x=null,M=[];h=1;let b=null,V=null;for(;h<=r;++h)for(b=p[h-1],V=p[h],u=1;u<=i;++u)1==h?(M.push(b[0].index),M.push(V[u].index),M.push(V[u-1].index)):h==r&&(M.push(b[u].index),M.push(V[0].index),M.push(b[u-1].index));for(b=p[p.length-2],V=p[p.length-1],u=1;u<=i;++u)M.push(b[u].index),M.push(V[u-1].index),M.push(b[u-1].index),M.push(b[u].index),M.push(V[u].index),M.push(V[u-1].index);let w=v.length,F=new Float32Array(3*w);for(h=0,u=0;u<w;++u)x=v[u],F[h]=x.x,F[h+1]=x.y,F[h+2]=x.z,h+=3;t.addFloat32Data(F,3);let A=new Uint16Array(M);A.length;if(t.isUVSEnabled()){let e=new Float32Array(2*w);for(h=0,u=0;u<w;++u)x=v[u],e[h]=x.u,e[h+1]=x.v,h+=2;t.addFloat32Data(e,2)}if(t.isNVSEnabled()){let e=new Float32Array(3*w);for(h=0,u=0;u<w;++u)x=v[u],e[h]=x.nx,e[h+1]=x.ny,e[h+2]=x.nz,h+=3;t.addFloat32Data(e,3)}t.setIVS(A)}}e.CylinderMeshBuilder=n},ae04:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s("0f76");class r extends i.MeshBuilder{constructor(){super(),this.m_posvs=null,this.m_colorvs=null,this.m_beginRad=0,this.m_rangeRad=0,this.color=CoRScene.createColor4(1,0,0,1),this.dynColorEnabled=!0}setRGB3f(t,e,s){this.color.setRGB3f(t,e,s)}createLineMesh(){let t=new Float32Array(this.m_posvs),e=CoMesh.createRawMesh();if(e.ivsEnabled=!1,e.aabbEnabled=!0,e.reset(),e.addFloat32Data(t,3),null!=this.m_colorvs){if(this.m_colorvs.length!=t.length)throw"Error: colorvs.length == vs.length";e.addFloat32Data(this.m_colorvs,3)}return e.vbWholeDataEnabled=!1,e.initialize(),e.toArraysLines(),e.vtCount=Math.floor(t.length/3),e}useColor(t){if(this.m_colorvs=null,!this.dynColorEnabled){this.m_colorvs=new Float32Array(3*t);for(let e=0;e<t;++e)this.color.toArray3(this.m_colorvs,3*e)}}createLine(t,e=null,s=0){this.m_posvs=new Float32Array([0,0,0,100,0,0]),null!=t&&t.toArray(this.m_posvs),null!=e&&e.toArray(this.m_posvs,3),this.useColor(2);let i=this.createLineMesh();if(s>1e-5){let r=s,a=CoMath.createAABB();a.min.setXYZ(t.x-r,t.y-r,t.z-r),a.max.setXYZ(t.x+r,t.y+r,t.z+r);let n=CoMath.createAABB();n.min.setXYZ(e.x-r,e.y-r,e.z-r),n.max.setXYZ(e.x+r,e.y+r,e.z+r),a.union(n),i.bounds.copyFrom(a),i.bounds.update()}return i}createRectXOY(t,e,s,i){return s+=t,i+=e,this.useColor(8),this.m_posvs=new Float32Array([t,e,0,s,e,0,s,e,0,s,i,0,s,i,0,t,i,0,t,i,0,t,e,0]),this.createLineMesh()}createRectXOZ(t,e,s,i){return s+=t,i+=e,this.useColor(8),this.m_posvs=new Float32Array([t,0,e,s,0,e,s,0,e,s,0,i,s,0,i,t,0,i,t,0,i,t,0,e]),this.createLineMesh()}createRectYOZ(t,e,s,i){return s+=t,i+=e,this.useColor(8),this.m_posvs=new Float32Array([0,t,e,0,s,e,0,s,e,0,s,i,0,s,i,0,t,i,0,t,i,0,t,e]),this.createLineMesh()}createCircle(t,e){this.m_posvs=new Float32Array(2*e*3);let s=0,i=0,r=this.m_posvs;for(let a=1;a<=e;++a)s=3*(a-1),r[i++]=t[s++],r[i++]=t[s++],r[i++]=t[s++],s=3*a,r[i++]=t[s++],r[i++]=t[s++],r[i++]=t[s++];this.useColor(2*e)}createCircleData(t,e,s,i,r,a){i<.001&&(i=.001),r<3&&(r=3),null==a&&(a=CoMath.createVec3());let n=new Array(3*(r+1)),l=0,h=this.m_rangeRad,u=h>0?h:2*Math.PI,o=[a.x,a.y,a.z];for(let c=0;c<=r;++c)h=this.m_beginRad+u*c/r,n[l+t]=o[t]+i*Math.cos(h),n[l+e]=o[e]+i*Math.sin(h),n[l+s]=o[s],l+=3;return n}createCircleXOY(t,e,s=null,i=0,r=0){this.m_beginRad=i,this.m_rangeRad=r;let a=this.createCircleData(0,1,2,t,e,s);return this.createCircle(a,e),this.createLineMesh()}createCircleXOZ(t,e,s=null,i=0,r=0){this.m_beginRad=i,this.m_rangeRad=r;let a=this.createCircleData(0,2,1,t,e,s);return this.createCircle(a,e),this.createLineMesh()}createCircleYOZ(t,e,s=null,i=0,r=0){this.m_beginRad=i,this.m_rangeRad=r;let a=this.createCircleData(1,2,0,t,e,s);return this.createCircle(a,e),this.createLineMesh()}createCurveByPositions(t,e=null){this.m_posvs=new Float32Array(6*t.length);let s=0;if(!this.dynColorEnabled)if(null==e)this.useColor(2*t.length);else{let i;this.m_colorvs=new Float32Array(6*t.length);for(let r=0;r<t.length;++r)i=e[r],i.fromArray3(this.m_colorvs,s),s+=3,i.fromArray3(this.m_colorvs,s),s+=3}s=0;for(let i=1;i<t.length;++i)t[i-1].toArray(this.m_posvs,s),s+=3,t[i].toArray(this.m_posvs,s),s+=3;return this.createLineMesh()}createPolygon(t,e=null){return this.createCurveByPositions(t,e)}createLines(t,e=null){if(t.length<1||t.length%2!=0)throw Error("illegal positions data for creating lines.");this.m_posvs=new Float32Array(3*t.length);let s=0;if(!this.dynColorEnabled)if(null==e)this.useColor(t.length);else{let i;this.m_colorvs=new Float32Array(3*t.length);for(let r=0;r<t.length;++r)i=e[r],i.fromArray3(this.m_colorvs,s),s+=3}s=0;for(let i=0;i<t.length;++i)t[i].toArray(this.m_posvs,s),s+=3;return this.createLineMesh()}createLinesWithFS32(t,e=null){if(t.length<3||t.length%3!=0)throw Error("illegal positions data for creating lines.");return this.m_posvs=t,this.dynColorEnabled||(null==e?this.useColor(t.length/3):this.m_colorvs=e),this.createLineMesh()}destroy(){this.m_colorvs=null,this.m_posvs=null}}e.LineMeshBuilder=r},d78b:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s("0f76");class r{constructor(){this.color0=CoRScene.createColor4(),this.color1=CoRScene.createColor4(),this.color2=CoRScene.createColor4(),this.color3=CoRScene.createColor4(),this.offsetU=0,this.offsetV=0,this.uScale=1,this.vScale=1,this.flipVerticalUV=!1,this.axisFlag=0,this.vtxTotal=4,this.trisNumber=2,this.vtCount=6,this.m_ivs=null,this.m_vs=null,this.m_uvs=null,this.m_nvs=null,this.m_cvs=null}getIVS(){return this.m_ivs}getVS(){return this.m_vs}getUVS(){return this.m_uvs}setUVS(t){null!=t&&8==t.length&&(null==this.m_uvs?this.m_uvs=t.slice(0):this.m_uvs.set(t))}getNVS(){return this.m_nvs}getCVS(){return this.m_cvs}initialize(t,e,s,i){if(null!=this.m_vs)return;let r=t,a=e,n=t+s,l=e+i,h=0;switch(this.m_ivs=new Uint16Array([0,1,2,0,2,3]),this.axisFlag){case 0:this.m_vs=new Float32Array([r,a,h,n,a,h,n,l,h,r,l,h]);break;case 1:this.m_vs=new Float32Array([n,h,a,r,h,a,r,h,l,n,h,l]);break;case 2:this.m_vs=new Float32Array([h,r,a,h,n,a,h,n,l,h,r,l]);break;default:break}switch(null==this.m_uvs&&(this.flipVerticalUV?this.m_uvs=new Float32Array([this.offsetU+0*this.uScale,this.offsetV+1*this.vScale,this.offsetU+1*this.uScale,this.offsetV+1*this.vScale,this.offsetU+1*this.uScale,this.offsetV+0*this.vScale,this.offsetU+0*this.uScale,this.offsetV+0*this.vScale]):this.m_uvs=new Float32Array([this.offsetU+0*this.uScale,this.offsetV+0*this.vScale,this.offsetU+1*this.uScale,this.offsetV+0*this.vScale,this.offsetU+1*this.uScale,this.offsetV+1*this.vScale,this.offsetU+0*this.uScale,this.offsetV+1*this.vScale])),this.axisFlag){case 0:this.m_nvs=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]);break;case 1:this.m_nvs=new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0]);break;case 2:this.m_nvs=new Float32Array([1,0,0,1,0,0,1,0,0,1,0,0]);break;default:break}this.vtxTotal=4,this.trisNumber=2,this.vtCount=6}}class a extends i.MeshBuilder{constructor(){super(),this.m_startX=0,this.m_startZ=0,this.m_pwidth=0,this.m_plong=0,this.m_flag=0,this.uvs=null,this.offsetU=0,this.offsetV=0,this.uScale=1,this.vScale=1,this.flipVerticalUV=!1,this.normalEnabled=!1,this.vbWholeDataEnabled=!1,this.wireframe=!1,this.polyhedral=!0}createCircle(t,e,s=0,i=0){t<.001&&(t=.001),e<1&&(e=1);let r=new Float32Array(3*(e+1)),a=new Uint16Array(3*e);r[0]=0,r[1]=0,r[2]=0;let n=3,l=0;i=l>0?i:2*Math.PI;for(let u=0;u<e;++u)l=s+i*u/e,r[n]=t*Math.cos(l),r[n+1]=t*Math.sin(l),r[n+2]=0,n+=3;n=0;for(let u=2;u<=e;++u)a[n++]=0,a[n++]=u-1,a[n++]=u;a[n++]=0,a[n++]=e,a[n++]=1;let h=CoRScene.createRawMesh();if(h.reset(),h.setTransformMatrix(this.transMatrix),h.setBufSortFormat(this.m_bufSortFormat),this.transMatrix=null,h.addFloat32Data(r,3),h.isUVSEnabled()){let t=new Float32Array(2*(e+1));t[0]=.5,t[1]=.5,n=2;for(let r=0;r<e;++r)l=s+i*r/e,t[n++]=.5*Math.cos(l)+.5,t[n++]=.5*Math.sin(l)+.5;h.addFloat32Data(t,2)}if(h.isNVSEnabled()){let t=new Float32Array(3*(e+1));n=0;for(let s=0;s<=e;++s)t[n++]=0,t[n++]=0,t[n++]=1;h.addFloat32Data(t,3)}return h.setIVS(a),h.initialize(),h}createFixScreen(t=-1,e=-1,s=2,i=2){return this.createXOY(-1,-1,2,2)}createXOY(t,e,s,i){return this.m_startX=t,this.m_startZ=e,this.m_pwidth=s,this.m_plong=i,this.m_flag=0,this.createPlaneMesh()}createXOYSquare(t){return this.m_startX=-.5*t,this.m_startZ=-.5*t,this.m_pwidth=t,this.m_plong=t,this.m_flag=0,this.createPlaneMesh()}createXOZ(t,e,s,i){return this.m_flag=1,this.m_startX=t,this.m_startZ=e,this.m_pwidth=s,this.m_plong=i,this.createPlaneMesh()}createYOZ(t,e,s,i){return this.m_flag=2,this.m_startX=t,this.m_startZ=e,this.m_pwidth=s,this.m_plong=i,this.createPlaneMesh()}createXOZSquare(t){return this.m_flag=1,this.m_startX=-.5*t,this.m_startZ=-.5*t,this.m_pwidth=t,this.m_plong=t,this.createPlaneMesh()}createPlaneMesh(){return this.createMesh()}setMeshData(t){let e=new r;e.uScale=this.uScale,e.vScale=this.vScale,e.offsetU=this.offsetU,e.offsetV=this.offsetV,e.flipVerticalUV=this.flipVerticalUV,e.axisFlag=this.m_flag,e.setUVS(this.uvs),e.initialize(this.m_startX,this.m_startZ,this.m_pwidth,this.m_plong),t.addFloat32Data(e.getVS(),3),t.isUVSEnabled()&&t.addFloat32Data(e.getUVS(),2),t.isNVSEnabled()&&t.addFloat32Data(e.getNVS(),3),t.setIVS(e.getIVS())}destroy(){this.uvs=null}}e.PlaneMeshBuilder=a},dae3:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(s("6fc6"));class a extends r.default{constructor(){super(),this.m_longitudeNum=0,this.m_latitudeNum=0,this.uScale=1,this.vScale=1}clone(){let t=new a;return t.m_longitudeNum=this.m_longitudeNum,t.m_latitudeNum=this.m_latitudeNum,t.uScale=this.uScale,t.vScale=this.vScale,t.copyFrom(this),t}getCenterAt(t,e){if(t>=0&&t<=this.m_latitudeNum&&null!=this.m_vs){e.setXYZ(0,0,0);let s=this.m_vs,i=(t+1)*(this.m_longitudeNum+1)*3;for(t=t*(this.m_longitudeNum+1)*3,i-=3;t<i;t+=3)e.x+=s[t],e.y+=s[t+1],e.z+=s[t+2];e.scaleBy(1/this.m_longitudeNum)}}transformAt(t,e){if(t>=0&&t<=this.m_latitudeNum){let s=this.m_vs,i=(t+1)*(this.m_longitudeNum+1)*3;t=t*(this.m_longitudeNum+1)*3,e.transformVectorsRangeSelf(s,t,i)}}getRangeAt(t,e=3){if(t>=0&&t<=this.m_latitudeNum){let s=(t+1)*(this.m_longitudeNum+1)*e;return t=t*(this.m_longitudeNum+1)*e,[t,s]}return[-1,-1]}initialize(t,e,s,i,r=1,a=-.5){let n=0,l=0;t<.01&&(t=.01),s<2&&(s=2),i<1&&(i=1),this.m_longitudeNum=s,this.m_latitudeNum=i;let h=Math.abs(t),u=Math.abs(e),o=0,c=0,m=0,d=a*u;null!=this.bounds&&(this.bounds.min.setXYZ(-t,d,-t),this.bounds.max.setXYZ(t,d+u,t),this.bounds.updateFast());let f,_=CoRScene.createVec3(),v=[],p=2*Math.PI;for(n=0;n<1;++n){for(l=0;l<s;++l)o=p*l/s,c=Math.sin(o),m=Math.cos(o),_.x=c*h,_.z=m*h,f=CoRScene.createVec3(_.x,_.y,_.z,1),v.push(f);v.push(v[0])}this.vtxTotal=(s+1)*(i+1),this.m_vs=new Float32Array(3*this.vtxTotal),this.m_uvs=new Float32Array(2*this.vtxTotal);let y=i,g=0,S=0;for(n=0;n<=y;++n)for(c=n/y,m=d+u*c,l=0;l<=s;++l){r<1?(this.m_uvs[S++]=this.uScale*(l/s),this.m_uvs[S++]=this.uScale*c):(this.m_uvs[S++]=this.uScale*c,this.m_uvs[S++]=this.uScale*(l/s));const t=v[l],e=this.m_vs;switch(this.axisType){case 1:e[g++]=t.x,e[g++]=m,e[g++]=t.z;break;case 2:e[g++]=t.z,e[g++]=t.x,e[g++]=m;break;default:e[g++]=m,e[g++]=t.z,e[g++]=t.x;break}}let x=s+1,M=0,b=0;for(this.m_ivs=new Uint16Array(y*s*6),g=0,n=0;n<y;++n)for(M=n*x,b=(n+1)*x,l=1;l<=s;++l)this.m_ivs[g++]=M+l,this.m_ivs[g++]=b+l-1,this.m_ivs[g++]=M+l-1,this.m_ivs[g++]=M+l,this.m_ivs[g++]=b+l,this.m_ivs[g++]=b+l-1;this.vtCount=this.m_ivs.length,this.trisNumber=this.vtCount/3}}e.default=a},f07f:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s("0f76");class r extends i.MeshBuilder{constructor(){super(),this.m_posList=new Array(8),this.flatNormal=!0,this.normalScale=1,this.uScale=1,this.vScale=1,this.flipVerticalUV=!1,this.uvPartsNumber=0}createCube(t){let e=.5*t,s=CoMath.createVec3(-e,-e,-e),i=CoMath.createVec3(e,e,e);return this.create(s,i)}create(t,e){return this.m_cv=t.clone().addBy(e).scaleBy(.5),this.m_posList[0]=[e.x,t.y,e.z],this.m_posList[1]=[e.x,t.y,t.z],this.m_posList[2]=[t.x,t.y,t.z],this.m_posList[3]=[t.x,t.y,e.z],this.m_posList[4]=[e.x,e.y,e.z],this.m_posList[5]=[e.x,e.y,t.z],this.m_posList[6]=[t.x,e.y,t.z],this.m_posList[7]=[t.x,e.y,e.z],this.createMesh()}scaleUVFaceAt(t,e,s,i,r,a){if(null!=t&&e>=0&&e<6){let n=8*e,l=n+8;for(;n<l;n+=2)t[n]=s+t[n]*r,t[n+1]=i+t[n+1]*a}}initUVData(t,e){let s=this.uScale,i=this.vScale,r=0;if(this.flipVerticalUV)while(r<t)e[r]=1*s,e[r+1]=1*i,e[r+2]=0*s,e[r+3]=1*i,e[r+4]=0*s,e[r+5]=0*i,e[r+6]=1*s,e[r+7]=0*i,r+=8;else while(r<t)e[r]=0*s,e[r+1]=0*i,e[r+2]=1*s,e[r+3]=0*i,e[r+4]=1*s,e[r+5]=1*i,e[r+6]=0*s,e[r+7]=1*i,r+=8}setMeshData(t){let e=[0,1,2,3,4,5,6,7,4,5,1,0,5,6,2,1,7,6,2,3,4,7,3,0],s=6,i=24,r=0,a=0,n=0,l=new Float32Array(72),h=new Uint16Array(36),u=[3,2,3,3,2,2];for(r=0;r<6;++r)3==u[r]?(h[n]=a+3,h[n+1]=a+2,h[n+2]=a+1,h[n+3]=a+3,h[n+4]=a+1,h[n+5]=a):(h[n]=a+2,h[n+1]=a+3,h[n+2]=a,h[n+3]=a+2,h[n+4]=a,h[n+5]=a+1),n+=6,a+=4;let o,c=e,m=this.m_posList;for(a=0,r=0;r<i;++r)o=m[c[r]],l.set(o,a),a+=3;if(t.addFloat32Data(l,3),t.isUVSEnabled()){let e=new Float32Array(48);this.initUVData(2*i,e),4==this.uvPartsNumber?(this.scaleUVFaceAt(e,0,.5,.5,.5,.5),this.scaleUVFaceAt(e,1,0,0,.5,.5),this.scaleUVFaceAt(e,2,.5,0,.5,.5),this.scaleUVFaceAt(e,3,0,.5,.5,.5),this.scaleUVFaceAt(e,4,.5,0,.5,.5),this.scaleUVFaceAt(e,5,0,.5,.5,.5)):6==this.uvPartsNumber&&(this.scaleUVFaceAt(e,0,0,0,.25,.5),this.scaleUVFaceAt(e,1,.25,0,.25,.5),this.scaleUVFaceAt(e,2,.5,0,.25,.5),this.scaleUVFaceAt(e,3,.75,0,.25,.5),this.scaleUVFaceAt(e,4,0,.5,.25,.5),this.scaleUVFaceAt(e,5,.25,.5,.25,.5)),t.addFloat32Data(e,2)}if(t.isNVSEnabled()){let e=new Float32Array(72);n=0;let a=0,h=0,u=0,o=this.normalScale;if(this.flatNormal)while(n<s){switch(a=0,h=0,u=0,n){case 0:h=-1;break;case 1:h=1;break;case 2:a=1;break;case 3:u=-1;break;case 4:a=-1;break;case 5:u=1;break;default:break}r=12*n,a*=o,h*=o,u*=o,e[r]=a,e[r+1]=h,e[r+2]=u,e[r+3]=a,e[r+4]=h,e[r+5]=u,e[r+6]=a,e[r+7]=h,e[r+8]=u,e[r+9]=a,e[r+10]=h,e[r+11]=u,++n}else{let t=this.m_cv,s=0;while(n<i)r=3*n,a=l[r]-t.x,h=l[r+1]-t.y,u=l[r+2]-t.z,s=Math.sqrt(a*a+h*h+u*u),s>1e-6&&(e[r]=a/s,e[r+1]=h/s,e[r+2]=u/s),++n}t.addFloat32Data(e,3)}t.setIVS(h)}}e.BoxMeshBuilder=r},fae3:function(t,e,s){"use strict";s.r(e);s("1eb2");var i=s("7f48");for(var r in i)["default"].indexOf(r)<0&&function(t){s.d(e,t,(function(){return i[t]}))}(r)}})}));