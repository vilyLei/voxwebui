(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["CoMouseInteraction"]=e():t["CoMouseInteraction"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="fae3")}({"0d32":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("1c92"),o=i("6b7e");class n{constructor(){this.m_stage3D=null,this.m_dragSwinger=new s.CamDragSwinger,this.m_dragSlider=new o.CamDragSlider,this.m_swing=!0,this.buttonType=0,this.bgEventEnabled=!0}initialize(t,e){if(null==this.m_stage3D){this.m_stage3D=t,this.m_dragSwinger.initialize(t,e),this.m_dragSlider.initialize(t,e);const i=CoRScene.MouseEvent;let s=i.MOUSE_DOWN;this.bgEventEnabled&&(s=i.MOUSE_BG_DOWN);let o=i.MOUSE_UP;1==this.buttonType?(s=this.bgEventEnabled?i.MOUSE_BG_MIDDLE_DOWN:i.MOUSE_MIDDLE_DOWN,o=i.MOUSE_MIDDLE_UP):2==this.buttonType&&(s=this.bgEventEnabled?i.MOUSE_BG_RIGHT_DOWN:i.MOUSE_RIGHT_DOWN,o=i.MOUSE_RIGHT_UP),t.addEventListener(s,this,this.mouseDownListener,!0,!1),t.addEventListener(o,this,this.mouseUpListener,!1,!0)}}setSlideSpeed(t){this.m_dragSlider.slideSpeed=t}enableSwing(){this.m_swing=!0}isEnabledSwing(){return this.m_swing}enableSlide(){this.m_swing=!1}mouseDownListener(t){this.attach()}mouseUpListener(t){this.detach()}attach(){this.m_dragSwinger.attach(),this.m_dragSlider.attach()}detach(){this.m_dragSwinger.detach(),this.m_dragSlider.detach()}runWithYAxis(){this.m_swing?this.m_dragSwinger.runWithYAxis():this.m_dragSlider.run()}runWithZAxis(){this.m_swing?this.m_dragSwinger.runWithZAxis():this.m_dragSlider.run()}}e.default=n},"1c92":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.m_stage3D=null,this.m_camera=null,this.m_mouseX=0,this.m_mouseY=0,this.m_enabled=!1,this.m_rotationSpeed=0,this.m_aotuRotationDelay=100,this.autoRotationEnabled=!1,this.autoRotationSpeed=.2,this.rotationAttenuationEnabled=!1,this.rotationSpeed=.2}initialize(t,e){null==this.m_stage3D&&(this.m_stage3D=t,this.m_camera=e)}attach(){this.m_mouseX=this.m_stage3D.mouseX,this.m_mouseY=this.m_stage3D.mouseY,this.m_enabled=!0,this.m_aotuRotationDelay=100}detach(){this.m_enabled=!1}runWithYAxis(){this.runWithAxis(CoRScene.Vector3D.Y_AXIS)}runWithZAxis(){this.runWithAxis(CoRScene.Vector3D.Z_AXIS)}run(t,e){if(this.m_enabled){let i=this.m_mouseX-this.m_stage3D.mouseX,s=this.m_mouseY-this.m_stage3D.mouseY,o=Math.abs(i),n=Math.abs(s);o>n?o>.5&&(e<1?this.m_camera.swingHorizontalWithAxis(.2*i,t):this.m_camera.swingHorizontal(.2*i)):n>.5&&this.m_camera.swingVertical(-.2*s),this.m_mouseX=this.m_stage3D.mouseX,this.m_mouseY=this.m_stage3D.mouseY}else this.autoRotationEnabled&&(this.m_aotuRotationDelay<0?e<1?this.m_camera.swingHorizontalWithAxis(this.autoRotationSpeed,t):this.m_camera.swingHorizontal(this.autoRotationSpeed):this.m_aotuRotationDelay--)}runWithAxis(t){this.run(t,0)}runWithCameraAxis(){this.run(null,1)}}e.CamDragSwinger=s},"1eb2":function(t,e,i){"use strict";if("undefined"!==typeof window){var s=window.document.currentScript,o=i("8875");s=o(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:o});var n=s&&s.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);n&&(i.p=n[1])}},"25a4":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i("0d32")),n=s(i("5082"));class r{constructor(){this.m_rscene=null,this.drager=new o.default,this.zoomer=new n.default,this.zoomLookAtPosition=null,this.zoomMinDistance=30,this.cameraCtrlEnabled=!0}initialize(t,e=0,i=!0){if(null==this.m_rscene){this.m_rscene=t,t.enableMouseEvent(!0);const s=this.drager,o=this.zoomer;s.buttonType=e,s.bgEventEnabled=i,s.initialize(t.getStage3D(),t.getCamera()),o.bindCamera(t.getCamera()),o.initialize(t.getStage3D()),o.setLookAtCtrlEnabled(!1)}}enableSwing(){this.drager.enableSwing()}isEnabledSwing(){return this.isEnabledSwing()}enableSlide(){this.drager.enableSlide()}setSyncLookAtEnabled(t){this.zoomer.syncLookAt=t}run(){this.cameraCtrlEnabled&&(this.zoomer.run(this.zoomLookAtPosition,this.zoomMinDistance),this.drager.runWithYAxis())}destroy(){}}e.MouseInteraction=r},5082:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.m_camera=null,this.m_touchZoomBoo=!1,this.m_preDis=0,this.m_touchZoomSpd=2,this.m_slideSpd=1,this.m_mouseWheelZoomSpd=6,this.m_tempa=CoRScene.createVec3(),this.m_tempb=CoRScene.createVec3(),this.m_preva=CoRScene.createVec3(),this.m_prevb=CoRScene.createVec3(),this.m_va=CoRScene.createVec3(),this.m_vb=CoRScene.createVec3(),this.m_lookAt=CoRScene.createVec3(),this.m_fowardDis=0,this.m_initBoo=!0,this.m_lookAtCtrlEnabled=!0,this.m_flagDrag=0,this.m_flagZoom=0,this.m_windowsEnvFlag=!0,this.syncLookAt=!1,this.m_flagType=2;const t=CoRenderer.RendererDevice;this.m_windowsEnvFlag=!(t.IsMobileWeb()||t.IsSafariWeb())}setMobileZoomSpeed(t){this.m_touchZoomSpd=t}seSlideSpeed(t){this.m_slideSpd=t}setMouseWheelZoomSpd(t){this.m_mouseWheelZoomSpd=t}bindCamera(t){this.m_camera=t}initialize(t){if(this.m_initBoo){this.m_initBoo=!1;const e=CoRScene.MouseEvent;t.addEventListener(e.MOUSE_WHEEL,this,this.mouseWheelListener,!0,!0),t.addEventListener(e.MOUSE_MULTI_MOVE,this,this.mouseMultiMoveListener,!0,!0),t.addEventListener(e.MOUSE_MULTI_UP,this,this.mouseMultiUpListener,!0,!0)}}setLookAtCtrlEnabled(t){this.m_lookAtCtrlEnabled=t}mouseWheelListener(t){t.wheelDeltaY>0?this.m_fowardDis+=this.m_mouseWheelZoomSpd:this.m_fowardDis-=this.m_mouseWheelZoomSpd}mouseMultiMoveListener(t){this.setTouchPosArray(t.posArray)}mouseMultiUpListener(t){this.setTouchPosArray(t.posArray)}resetState(){this.m_flagDrag=0,this.m_flagZoom=0,this.m_flagType=0}setTouchPosArray(t){if(null!=t&&t.length>1){const e=CoRScene.Vector3D;let i=0;if(this.m_va.setXYZ(t[0].x,t[0].y,0),this.m_vb.setXYZ(t[1].x,t[1].y,0),this.m_touchZoomBoo){i=e.Distance(this.m_va,this.m_vb),this.m_flagType<1?(this.m_tempa.copyFrom(this.m_va),this.m_tempb.copyFrom(this.m_vb),this.m_tempa.subVecsTo(this.m_va,this.m_preva),this.m_tempb.subVecsTo(this.m_vb,this.m_prevb),this.m_tempa.normalize(),this.m_tempb.normalize(),this.m_tempa.dot(this.m_tempb)>.9?this.m_flagDrag++:this.m_flagZoom++,(this.m_flagDrag>3||this.m_flagZoom>3)&&(this.m_flagType=this.m_flagDrag>this.m_flagZoom?1:2)):this.m_tempa.subVecsTo(this.m_va,this.m_preva);let t=Math.abs(this.m_preDis-i);t>.1&&(this.m_fowardDis=(i-this.m_preDis)*this.m_touchZoomSpd,this.m_preDis=i)}else this.m_touchZoomBoo=!0,this.m_preDis=e.Distance(this.m_va,this.m_vb),this.resetState()}else this.resetState(),this.m_touchZoomBoo=!1;this.m_preva.copyFrom(this.m_va),this.m_prevb.copyFrom(this.m_vb)}run(t,e){let i=this.m_lookAtCtrlEnabled;if(null==t&&(t=this.m_lookAt),null!=this.m_camera)if(this.syncLookAt&&this.m_camera.setLookAtPosition(t),2==this.m_flagType){const s=CoRScene.Vector3D;if(Math.abs(this.m_fowardDis)>.001){let o=s.Distance(this.m_camera.getPosition(),this.m_camera.getLookAtPosition()),n=this.m_fowardDis;this.m_fowardDis>0&&(o>e?(n=o-e,n>this.m_fowardDis&&(n=this.m_fowardDis)):n=0),Math.abs(n)>.1&&(this.m_camera.forward(n),i&&this.m_camera.setLookPosXYZFixUp(t.x,t.y,t.z)),this.m_windowsEnvFlag?this.m_fowardDis*=.95:this.m_fowardDis=0}}else 1==this.m_flagType&&this.m_camera.slideViewOffsetXY(-this.m_tempa.x*this.m_slideSpd,this.m_tempa.y*this.m_slideSpd)}}e.default=s},"6b7e":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.m_stage3D=null,this.m_camera=null,this.slideSpeed=2,this.m_mouseX=0,this.m_mouseY=0,this.m_enabled=!1}initialize(t,e){null==this.m_stage3D&&(this.m_stage3D=t,this.m_camera=e)}attach(){this.m_mouseX=this.m_stage3D.mouseX,this.m_mouseY=this.m_stage3D.mouseY,this.m_enabled=!0}detach(){this.m_enabled=!1}run(){if(this.m_enabled){let t=(this.m_mouseX-this.m_stage3D.mouseX)*this.slideSpeed,e=(this.m_mouseY-this.m_stage3D.mouseY)*this.slideSpeed;this.m_camera.slideViewOffsetXY(t,e),this.m_mouseX=this.m_stage3D.mouseX,this.m_mouseY=this.m_stage3D.mouseY}}}e.CamDragSlider=s},8875:function(t,e,i){var s,o,n;(function(i,r){o=[],s=r,n="function"===typeof s?s.apply(e,o):s,void 0===n||(t.exports=n)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(_){var i,s,o,n=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,r=/@([^@]*):(\d+):(\d+)\s*$/gi,a=n.exec(_.stack)||r.exec(_.stack),m=a&&a[1]||!1,h=a&&a[2]||!1,u=document.location.href.replace(document.location.hash,""),c=document.getElementsByTagName("script");m===u&&(i=document.documentElement.outerHTML,s=new RegExp("(?:[^\\n]+?\\n){0,"+(h-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),o=i.replace(s,"$1").trim());for(var l=0;l<c.length;l++){if("interactive"===c[l].readyState)return c[l];if(c[l].src===m)return c[l];if(m===u&&c[l].innerHTML&&c[l].innerHTML.trim()===o)return c[l]}return null}}return t}))},b346:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("25a4");function o(){return new s.MouseInteraction}e.MouseInteraction=s.MouseInteraction,e.createMouseInteraction=o},fae3:function(t,e,i){"use strict";i.r(e);i("1eb2");var s=i("b346");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o)}})}));